# .gitignore

```
target/
!.mvn/wrapper/maven-wrapper.jar
!**/src/main/**/target/
!**/src/test/**/target/

### IntelliJ IDEA ###
.idea/modules.xml
.idea/jarRepositories.xml
.idea/compiler.xml
.idea/libraries/
*.iws
*.iml
*.ipr

### Eclipse ###
.apt_generated
.classpath
.factorypath
.project
.settings
.springBeans
.sts4-cache

### NetBeans ###
/nbproject/private/
/nbbuild/
/dist/
/nbdist/
/.nb-gradle/
build/
!**/src/main/**/build/
!**/src/test/**/build/

### VS Code ###
.vscode/

### Mac OS ###
.DS_Store
```

# .idea\compiler.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CompilerConfiguration">
    <annotationProcessing>
      <profile name="Maven default annotation processors profile" enabled="true">
        <sourceOutputDir name="target/generated-sources/annotations" />
        <sourceTestOutputDir name="target/generated-test-sources/test-annotations" />
        <outputRelativeToContentRoot value="true" />
        <module name="cineplex" />
      </profile>
    </annotationProcessing>
  </component>
</project>
```

# .idea\encodings.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="Encoding">
    <file url="file://$PROJECT_DIR$/src/main/java" charset="UTF-8" />
    <file url="file://$PROJECT_DIR$/src/main/resources" charset="UTF-8" />
  </component>
</project>
```

# .idea\jarRepositories.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="RemoteRepositoriesConfiguration">
    <remote-repository>
      <option name="id" value="central" />
      <option name="name" value="Central Repository" />
      <option name="url" value="https://repo.maven.apache.org/maven2" />
    </remote-repository>
    <remote-repository>
      <option name="id" value="central" />
      <option name="name" value="Maven Central repository" />
      <option name="url" value="https://repo1.maven.org/maven2" />
    </remote-repository>
    <remote-repository>
      <option name="id" value="jboss.community" />
      <option name="name" value="JBoss Community repository" />
      <option name="url" value="https://repository.jboss.org/nexus/content/repositories/public/" />
    </remote-repository>
  </component>
</project>
```

# .idea\misc.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="ExternalStorageConfigurationManager" enabled="true" />
  <component name="MavenProjectsManager">
    <option name="originalFiles">
      <list>
        <option value="$PROJECT_DIR$/pom.xml" />
      </list>
    </option>
  </component>
  <component name="ProjectRootManager" version="2" languageLevel="JDK_17" default="true" project-jdk-name="17" project-jdk-type="JavaSDK">
    <output url="file://$PROJECT_DIR$/out" />
  </component>
</project>
```

# .idea\uiDesigner.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="Palette2">
    <group name="Swing">
      <item class="com.intellij.uiDesigner.HSpacer" tooltip-text="Horizontal Spacer" icon="/com/intellij/uiDesigner/icons/hspacer.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="1" hsize-policy="6" anchor="0" fill="1" />
      </item>
      <item class="com.intellij.uiDesigner.VSpacer" tooltip-text="Vertical Spacer" icon="/com/intellij/uiDesigner/icons/vspacer.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="6" hsize-policy="1" anchor="0" fill="2" />
      </item>
      <item class="javax.swing.JPanel" icon="/com/intellij/uiDesigner/icons/panel.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="3" hsize-policy="3" anchor="0" fill="3" />
      </item>
      <item class="javax.swing.JScrollPane" icon="/com/intellij/uiDesigner/icons/scrollPane.svg" removable="false" auto-create-binding="false" can-attach-label="true">
        <default-constraints vsize-policy="7" hsize-policy="7" anchor="0" fill="3" />
      </item>
      <item class="javax.swing.JButton" icon="/com/intellij/uiDesigner/icons/button.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="3" anchor="0" fill="1" />
        <initial-values>
          <property name="text" value="Button" />
        </initial-values>
      </item>
      <item class="javax.swing.JRadioButton" icon="/com/intellij/uiDesigner/icons/radioButton.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="3" anchor="8" fill="0" />
        <initial-values>
          <property name="text" value="RadioButton" />
        </initial-values>
      </item>
      <item class="javax.swing.JCheckBox" icon="/com/intellij/uiDesigner/icons/checkBox.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="3" anchor="8" fill="0" />
        <initial-values>
          <property name="text" value="CheckBox" />
        </initial-values>
      </item>
      <item class="javax.swing.JLabel" icon="/com/intellij/uiDesigner/icons/label.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="0" anchor="8" fill="0" />
        <initial-values>
          <property name="text" value="Label" />
        </initial-values>
      </item>
      <item class="javax.swing.JTextField" icon="/com/intellij/uiDesigner/icons/textField.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="0" hsize-policy="6" anchor="8" fill="1">
          <preferred-size width="150" height="-1" />
        </default-constraints>
      </item>
      <item class="javax.swing.JPasswordField" icon="/com/intellij/uiDesigner/icons/passwordField.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="0" hsize-policy="6" anchor="8" fill="1">
          <preferred-size width="150" height="-1" />
        </default-constraints>
      </item>
      <item class="javax.swing.JFormattedTextField" icon="/com/intellij/uiDesigner/icons/formattedTextField.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="0" hsize-policy="6" anchor="8" fill="1">
          <preferred-size width="150" height="-1" />
        </default-constraints>
      </item>
      <item class="javax.swing.JTextArea" icon="/com/intellij/uiDesigner/icons/textArea.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="6" hsize-policy="6" anchor="0" fill="3">
          <preferred-size width="150" height="50" />
        </default-constraints>
      </item>
      <item class="javax.swing.JTextPane" icon="/com/intellij/uiDesigner/icons/textPane.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="6" hsize-policy="6" anchor="0" fill="3">
          <preferred-size width="150" height="50" />
        </default-constraints>
      </item>
      <item class="javax.swing.JEditorPane" icon="/com/intellij/uiDesigner/icons/editorPane.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="6" hsize-policy="6" anchor="0" fill="3">
          <preferred-size width="150" height="50" />
        </default-constraints>
      </item>
      <item class="javax.swing.JComboBox" icon="/com/intellij/uiDesigner/icons/comboBox.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="0" hsize-policy="2" anchor="8" fill="1" />
      </item>
      <item class="javax.swing.JTable" icon="/com/intellij/uiDesigner/icons/table.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="6" hsize-policy="6" anchor="0" fill="3">
          <preferred-size width="150" height="50" />
        </default-constraints>
      </item>
      <item class="javax.swing.JList" icon="/com/intellij/uiDesigner/icons/list.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="6" hsize-policy="2" anchor="0" fill="3">
          <preferred-size width="150" height="50" />
        </default-constraints>
      </item>
      <item class="javax.swing.JTree" icon="/com/intellij/uiDesigner/icons/tree.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="6" hsize-policy="6" anchor="0" fill="3">
          <preferred-size width="150" height="50" />
        </default-constraints>
      </item>
      <item class="javax.swing.JTabbedPane" icon="/com/intellij/uiDesigner/icons/tabbedPane.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="3" hsize-policy="3" anchor="0" fill="3">
          <preferred-size width="200" height="200" />
        </default-constraints>
      </item>
      <item class="javax.swing.JSplitPane" icon="/com/intellij/uiDesigner/icons/splitPane.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="3" hsize-policy="3" anchor="0" fill="3">
          <preferred-size width="200" height="200" />
        </default-constraints>
      </item>
      <item class="javax.swing.JSpinner" icon="/com/intellij/uiDesigner/icons/spinner.svg" removable="false" auto-create-binding="true" can-attach-label="true">
        <default-constraints vsize-policy="0" hsize-policy="6" anchor="8" fill="1" />
      </item>
      <item class="javax.swing.JSlider" icon="/com/intellij/uiDesigner/icons/slider.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="6" anchor="8" fill="1" />
      </item>
      <item class="javax.swing.JSeparator" icon="/com/intellij/uiDesigner/icons/separator.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="6" hsize-policy="6" anchor="0" fill="3" />
      </item>
      <item class="javax.swing.JProgressBar" icon="/com/intellij/uiDesigner/icons/progressbar.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="6" anchor="0" fill="1" />
      </item>
      <item class="javax.swing.JToolBar" icon="/com/intellij/uiDesigner/icons/toolbar.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="6" anchor="0" fill="1">
          <preferred-size width="-1" height="20" />
        </default-constraints>
      </item>
      <item class="javax.swing.JToolBar$Separator" icon="/com/intellij/uiDesigner/icons/toolbarSeparator.svg" removable="false" auto-create-binding="false" can-attach-label="false">
        <default-constraints vsize-policy="0" hsize-policy="0" anchor="0" fill="1" />
      </item>
      <item class="javax.swing.JScrollBar" icon="/com/intellij/uiDesigner/icons/scrollbar.svg" removable="false" auto-create-binding="true" can-attach-label="false">
        <default-constraints vsize-policy="6" hsize-policy="0" anchor="0" fill="2" />
      </item>
    </group>
  </component>
</project>
```

# .idea\vcs.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="VcsDirectoryMappings">
    <mapping directory="$PROJECT_DIR$" vcs="Git" />
  </component>
</project>
```

# .idea\workspace.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="ArtifactsWorkspaceSettings">
    <artifacts-to-build>
      <artifact name="cineplex:war exploded" />
    </artifacts-to-build>
  </component>
  <component name="AutoImportSettings">
    <option name="autoReloadType" value="SELECTIVE" />
  </component>
  <component name="ChangeListManager">
    <list default="true" id="786216fe-ac20-4715-b701-e87ef05bdb1e" name="Changes" comment="">
      <change afterPath="$PROJECT_DIR$/src/main/java/com/cineplex/cineplex/controller/FilmManagement.java" afterDir="false" />
      <change afterPath="$PROJECT_DIR$/src/main/webapp/jsp/filmManagement/film.jsp" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/src/main/java/com/cineplex/cineplex/controller/HomeManagement.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/cineplex/cineplex/controller/HomeManagement.java" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/src/main/java/com/cineplex/cineplex/model/dao/mySQLJDBCImpl/FilmDAOMySQLJDBCImpl.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/cineplex/cineplex/model/dao/mySQLJDBCImpl/FilmDAOMySQLJDBCImpl.java" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/src/main/webapp/WEB-INF/web.xml" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/web.xml" afterDir="false" />
      <change beforePath="$PROJECT_DIR$/src/main/webapp/jsp/homeManagement/view.jsp" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/jsp/homeManagement/view.jsp" afterDir="false" />
    </list>
    <option name="SHOW_DIALOG" value="false" />
    <option name="HIGHLIGHT_CONFLICTS" value="true" />
    <option name="HIGHLIGHT_NON_ACTIVE_CHANGELIST" value="false" />
    <option name="LAST_RESOLUTION" value="IGNORE" />
  </component>
  <component name="FileTemplateManagerImpl">
    <option name="RECENT_TEMPLATES">
      <list>
        <option value="Interface" />
        <option value="Class" />
        <option value="Jsp File" />
      </list>
    </option>
  </component>
  <component name="Git.Settings">
    <option name="RECENT_GIT_ROOT_PATH" value="$PROJECT_DIR$" />
  </component>
  <component name="LogFilters">
    <option name="FILTER_ERRORS" value="false" />
    <option name="FILTER_WARNINGS" value="false" />
    <option name="FILTER_INFO" value="true" />
    <option name="FILTER_DEBUG" value="true" />
    <option name="CUSTOM_FILTER" />
  </component>
  <component name="MarkdownSettingsMigration">
    <option name="stateVersion" value="1" />
  </component>
  <component name="MavenImportPreferences">
    <option name="generalSettings">
      <MavenGeneralSettings>
        <option name="mavenHome" value="Use Maven wrapper" />
      </MavenGeneralSettings>
    </option>
  </component>
  <component name="ProjectColorInfo">{
  &quot;associatedIndex&quot;: 1
}</component>
  <component name="ProjectId" id="2mQjkRtBfJJUXvoZXeSeLBqP7Dc" />
  <component name="ProjectLevelVcsManager" settingsEditedManually="true">
    <ConfirmationsSetting value="2" id="Add" />
  </component>
  <component name="ProjectViewState">
    <option name="hideEmptyMiddlePackages" value="true" />
    <option name="showLibraryContents" value="true" />
  </component>
  <component name="PropertiesComponent">{
  &quot;keyToString&quot;: {
    &quot;Maven.cineplex [install].executor&quot;: &quot;Run&quot;,
    &quot;RunOnceActivity.OpenProjectViewOnStart&quot;: &quot;true&quot;,
    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,
    &quot;SHARE_PROJECT_CONFIGURATION_FILES&quot;: &quot;true&quot;,
    &quot;Tomcat Server.Tomcat 10.1.30.executor&quot;: &quot;Run&quot;,
    &quot;git-widget-placeholder&quot;: &quot;main&quot;,
    &quot;ignore.virus.scanning.warn.message&quot;: &quot;true&quot;,
    &quot;kotlin-language-version-configured&quot;: &quot;true&quot;,
    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,
    &quot;node.js.detected.package.tslint&quot;: &quot;true&quot;,
    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,
    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,
    &quot;nodejs_package_manager_path&quot;: &quot;npm&quot;,
    &quot;project.structure.last.edited&quot;: &quot;Project&quot;,
    &quot;project.structure.proportion&quot;: &quot;0.0&quot;,
    &quot;project.structure.side.proportion&quot;: &quot;0.0&quot;,
    &quot;settings.editor.selected.configurable&quot;: &quot;preferences.pluginManager&quot;,
    &quot;vue.rearranger.settings.migration&quot;: &quot;true&quot;
  }
}</component>
  <component name="RecentsManager">
    <key name="MoveFile.RECENT_KEYS">
      <recent name="C:\Users\bagyb\Projects\cineplex\src\main\webapp" />
    </key>
    <key name="MoveClassesOrPackagesDialog.RECENTS_KEY">
      <recent name="com.cineplex.cineplex.model.dao" />
    </key>
  </component>
  <component name="RunManager">
    <configuration name="Tomcat 10.1.30" type="#com.intellij.j2ee.web.tomcat.TomcatRunConfigurationFactory" factoryName="Local" APPLICATION_SERVER_NAME="Tomcat 10.1.30" ALTERNATIVE_JRE_ENABLED="false">
      <deployment>
        <artifact name="cineplex:war exploded">
          <settings>
            <option name="CONTEXT_PATH" value="/cineplex_war_exploded" />
          </settings>
        </artifact>
      </deployment>
      <server-settings>
        <option name="BASE_DIRECTORY_NAME" value="40749c26-3499-4ba4-b4f8-d3f22ef8d76c" />
      </server-settings>
      <predefined_log_file enabled="true" id="Tomcat" />
      <predefined_log_file enabled="true" id="Tomcat Catalina" />
      <predefined_log_file id="Tomcat Manager" />
      <predefined_log_file id="Tomcat Host Manager" />
      <predefined_log_file id="Tomcat Localhost Access" />
      <RunnerSettings RunnerId="Debug">
        <option name="DEBUG_PORT" value="56992" />
      </RunnerSettings>
      <ConfigurationWrapper VM_VAR="JAVA_OPTS" RunnerId="Cover">
        <option name="USE_ENV_VARIABLES" value="true" />
        <STARTUP>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </STARTUP>
        <SHUTDOWN>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </SHUTDOWN>
      </ConfigurationWrapper>
      <ConfigurationWrapper VM_VAR="JAVA_OPTS" RunnerId="Debug">
        <option name="USE_ENV_VARIABLES" value="true" />
        <STARTUP>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </STARTUP>
        <SHUTDOWN>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </SHUTDOWN>
      </ConfigurationWrapper>
      <ConfigurationWrapper VM_VAR="JAVA_OPTS" RunnerId="Profile">
        <option name="USE_ENV_VARIABLES" value="true" />
        <STARTUP>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </STARTUP>
        <SHUTDOWN>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </SHUTDOWN>
      </ConfigurationWrapper>
      <ConfigurationWrapper VM_VAR="JAVA_OPTS" RunnerId="Run">
        <option name="USE_ENV_VARIABLES" value="true" />
        <STARTUP>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </STARTUP>
        <SHUTDOWN>
          <option name="USE_DEFAULT" value="true" />
          <option name="SCRIPT" value="" />
          <option name="VM_PARAMETERS" value="" />
          <option name="PROGRAM_PARAMETERS" value="" />
        </SHUTDOWN>
      </ConfigurationWrapper>
      <method v="2">
        <option name="Make" enabled="true" />
        <option name="BuildArtifacts" enabled="true">
          <artifact name="cineplex:war exploded" />
        </option>
      </method>
    </configuration>
  </component>
  <component name="SpellCheckerSettings" RuntimeDictionaries="0" Folders="0" CustomDictionaries="0" DefaultDictionary="application-level" UseSingleDictionary="true" transferred="true" />
  <component name="TaskManager">
    <task active="true" id="Default" summary="Default task">
      <changelist id="786216fe-ac20-4715-b701-e87ef05bdb1e" name="Changes" comment="" />
      <created>1727015837073</created>
      <option name="number" value="Default" />
      <option name="presentableId" value="Default" />
      <updated>1727015837073</updated>
      <workItem from="1727015838085" duration="36000" />
      <workItem from="1727015882113" duration="6013000" />
      <workItem from="1727451200811" duration="13647000" />
      <workItem from="1727637919106" duration="6249000" />
      <workItem from="1727707360760" duration="3799000" />
      <workItem from="1727821850671" duration="1132000" />
      <workItem from="1727965337132" duration="583000" />
      <workItem from="1727965927955" duration="7254000" />
      <workItem from="1728049567772" duration="7084000" />
      <workItem from="1728141003072" duration="3445000" />
      <workItem from="1728144722713" duration="2273000" />
      <workItem from="1728312004615" duration="6836000" />
      <workItem from="1728397915567" duration="8002000" />
      <workItem from="1728470716893" duration="116000" />
      <workItem from="1728470842470" duration="10637000" />
      <workItem from="1728665375587" duration="367000" />
      <workItem from="1728921331868" duration="7755000" />
    </task>
    <servers />
  </component>
  <component name="TypeScriptGeneratedFilesManager">
    <option name="version" value="3" />
  </component>
  <component name="UnknownFeatures">
    <option featureType="com.intellij.fileTypeFactory" implementationName="*.inc" />
  </component>
</project>
```

# .mvn\wrapper\maven-wrapper.jar

This is a binary file of the type: Binary

# .mvn\wrapper\maven-wrapper.properties

```properties
distributionUrl=https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.8.5/apache-maven-3.8.5-bin.zip
wrapperUrl=https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar
```

# mvnw

```
#!/bin/sh
# ----------------------------------------------------------------------------
# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#    https://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
# ----------------------------------------------------------------------------

# ----------------------------------------------------------------------------
# Maven Start Up Batch script
#
# Required ENV vars:
# ------------------
#   JAVA_HOME - location of a JDK home dir
#
# Optional ENV vars
# -----------------
#   M2_HOME - location of maven2's installed home dir
#   MAVEN_OPTS - parameters passed to the Java VM when running Maven
#     e.g. to debug Maven itself, use
#       set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000
#   MAVEN_SKIP_RC - flag to disable loading of mavenrc files
# ----------------------------------------------------------------------------

if [ -z "$MAVEN_SKIP_RC" ] ; then

  if [ -f /usr/local/etc/mavenrc ] ; then
    . /usr/local/etc/mavenrc
  fi

  if [ -f /etc/mavenrc ] ; then
    . /etc/mavenrc
  fi

  if [ -f "$HOME/.mavenrc" ] ; then
    . "$HOME/.mavenrc"
  fi

fi

# OS specific support.  $var _must_ be set to either true or false.
cygwin=false;
darwin=false;
mingw=false
case "`uname`" in
  CYGWIN*) cygwin=true ;;
  MINGW*) mingw=true;;
  Darwin*) darwin=true
    # Use /usr/libexec/java_home if available, otherwise fall back to /Library/Java/Home
    # See https://developer.apple.com/library/mac/qa/qa1170/_index.html
    if [ -z "$JAVA_HOME" ]; then
      if [ -x "/usr/libexec/java_home" ]; then
        export JAVA_HOME="`/usr/libexec/java_home`"
      else
        export JAVA_HOME="/Library/Java/Home"
      fi
    fi
    ;;
esac

if [ -z "$JAVA_HOME" ] ; then
  if [ -r /etc/gentoo-release ] ; then
    JAVA_HOME=`java-config --jre-home`
  fi
fi

if [ -z "$M2_HOME" ] ; then
  ## resolve links - $0 may be a link to maven's home
  PRG="$0"

  # need this for relative symlinks
  while [ -h "$PRG" ] ; do
    ls=`ls -ld "$PRG"`
    link=`expr "$ls" : '.*-> \(.*\)$'`
    if expr "$link" : '/.*' > /dev/null; then
      PRG="$link"
    else
      PRG="`dirname "$PRG"`/$link"
    fi
  done

  saveddir=`pwd`

  M2_HOME=`dirname "$PRG"`/..

  # make it fully qualified
  M2_HOME=`cd "$M2_HOME" && pwd`

  cd "$saveddir"
  # echo Using m2 at $M2_HOME
fi

# For Cygwin, ensure paths are in UNIX format before anything is touched
if $cygwin ; then
  [ -n "$M2_HOME" ] &&
    M2_HOME=`cygpath --unix "$M2_HOME"`
  [ -n "$JAVA_HOME" ] &&
    JAVA_HOME=`cygpath --unix "$JAVA_HOME"`
  [ -n "$CLASSPATH" ] &&
    CLASSPATH=`cygpath --path --unix "$CLASSPATH"`
fi

# For Mingw, ensure paths are in UNIX format before anything is touched
if $mingw ; then
  [ -n "$M2_HOME" ] &&
    M2_HOME="`(cd "$M2_HOME"; pwd)`"
  [ -n "$JAVA_HOME" ] &&
    JAVA_HOME="`(cd "$JAVA_HOME"; pwd)`"
fi

if [ -z "$JAVA_HOME" ]; then
  javaExecutable="`which javac`"
  if [ -n "$javaExecutable" ] && ! [ "`expr \"$javaExecutable\" : '\([^ ]*\)'`" = "no" ]; then
    # readlink(1) is not available as standard on Solaris 10.
    readLink=`which readlink`
    if [ ! `expr "$readLink" : '\([^ ]*\)'` = "no" ]; then
      if $darwin ; then
        javaHome="`dirname \"$javaExecutable\"`"
        javaExecutable="`cd \"$javaHome\" && pwd -P`/javac"
      else
        javaExecutable="`readlink -f \"$javaExecutable\"`"
      fi
      javaHome="`dirname \"$javaExecutable\"`"
      javaHome=`expr "$javaHome" : '\(.*\)/bin'`
      JAVA_HOME="$javaHome"
      export JAVA_HOME
    fi
  fi
fi

if [ -z "$JAVACMD" ] ; then
  if [ -n "$JAVA_HOME"  ] ; then
    if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
      # IBM's JDK on AIX uses strange locations for the executables
      JAVACMD="$JAVA_HOME/jre/sh/java"
    else
      JAVACMD="$JAVA_HOME/bin/java"
    fi
  else
    JAVACMD="`\\unset -f command; \\command -v java`"
  fi
fi

if [ ! -x "$JAVACMD" ] ; then
  echo "Error: JAVA_HOME is not defined correctly." >&2
  echo "  We cannot execute $JAVACMD" >&2
  exit 1
fi

if [ -z "$JAVA_HOME" ] ; then
  echo "Warning: JAVA_HOME environment variable is not set."
fi

CLASSWORLDS_LAUNCHER=org.codehaus.plexus.classworlds.launcher.Launcher

# traverses directory structure from process work directory to filesystem root
# first directory with .mvn subdirectory is considered project base directory
find_maven_basedir() {

  if [ -z "$1" ]
  then
    echo "Path not specified to find_maven_basedir"
    return 1
  fi

  basedir="$1"
  wdir="$1"
  while [ "$wdir" != '/' ] ; do
    if [ -d "$wdir"/.mvn ] ; then
      basedir=$wdir
      break
    fi
    # workaround for JBEAP-8937 (on Solaris 10/Sparc)
    if [ -d "${wdir}" ]; then
      wdir=`cd "$wdir/.."; pwd`
    fi
    # end of workaround
  done
  echo "${basedir}"
}

# concatenates all lines of a file
concat_lines() {
  if [ -f "$1" ]; then
    echo "$(tr -s '\n' ' ' < "$1")"
  fi
}

BASE_DIR=`find_maven_basedir "$(pwd)"`
if [ -z "$BASE_DIR" ]; then
  exit 1;
fi

##########################################################################################
# Extension to allow automatically downloading the maven-wrapper.jar from Maven-central
# This allows using the maven wrapper in projects that prohibit checking in binary data.
##########################################################################################
if [ -r "$BASE_DIR/.mvn/wrapper/maven-wrapper.jar" ]; then
    if [ "$MVNW_VERBOSE" = true ]; then
      echo "Found .mvn/wrapper/maven-wrapper.jar"
    fi
else
    if [ "$MVNW_VERBOSE" = true ]; then
      echo "Couldn't find .mvn/wrapper/maven-wrapper.jar, downloading it ..."
    fi
    if [ -n "$MVNW_REPOURL" ]; then
      jarUrl="$MVNW_REPOURL/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
    else
      jarUrl="https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
    fi
    while IFS="=" read key value; do
      case "$key" in (wrapperUrl) jarUrl="$value"; break ;;
      esac
    done < "$BASE_DIR/.mvn/wrapper/maven-wrapper.properties"
    if [ "$MVNW_VERBOSE" = true ]; then
      echo "Downloading from: $jarUrl"
    fi
    wrapperJarPath="$BASE_DIR/.mvn/wrapper/maven-wrapper.jar"
    if $cygwin; then
      wrapperJarPath=`cygpath --path --windows "$wrapperJarPath"`
    fi

    if command -v wget > /dev/null; then
        if [ "$MVNW_VERBOSE" = true ]; then
          echo "Found wget ... using wget"
        fi
        if [ -z "$MVNW_USERNAME" ] || [ -z "$MVNW_PASSWORD" ]; then
            wget "$jarUrl" -O "$wrapperJarPath" || rm -f "$wrapperJarPath"
        else
            wget --http-user=$MVNW_USERNAME --http-password=$MVNW_PASSWORD "$jarUrl" -O "$wrapperJarPath" || rm -f "$wrapperJarPath"
        fi
    elif command -v curl > /dev/null; then
        if [ "$MVNW_VERBOSE" = true ]; then
          echo "Found curl ... using curl"
        fi
        if [ -z "$MVNW_USERNAME" ] || [ -z "$MVNW_PASSWORD" ]; then
            curl -o "$wrapperJarPath" "$jarUrl" -f
        else
            curl --user $MVNW_USERNAME:$MVNW_PASSWORD -o "$wrapperJarPath" "$jarUrl" -f
        fi

    else
        if [ "$MVNW_VERBOSE" = true ]; then
          echo "Falling back to using Java to download"
        fi
        javaClass="$BASE_DIR/.mvn/wrapper/MavenWrapperDownloader.java"
        # For Cygwin, switch paths to Windows format before running javac
        if $cygwin; then
          javaClass=`cygpath --path --windows "$javaClass"`
        fi
        if [ -e "$javaClass" ]; then
            if [ ! -e "$BASE_DIR/.mvn/wrapper/MavenWrapperDownloader.class" ]; then
                if [ "$MVNW_VERBOSE" = true ]; then
                  echo " - Compiling MavenWrapperDownloader.java ..."
                fi
                # Compiling the Java class
                ("$JAVA_HOME/bin/javac" "$javaClass")
            fi
            if [ -e "$BASE_DIR/.mvn/wrapper/MavenWrapperDownloader.class" ]; then
                # Running the downloader
                if [ "$MVNW_VERBOSE" = true ]; then
                  echo " - Running MavenWrapperDownloader.java ..."
                fi
                ("$JAVA_HOME/bin/java" -cp .mvn/wrapper MavenWrapperDownloader "$MAVEN_PROJECTBASEDIR")
            fi
        fi
    fi
fi
##########################################################################################
# End of extension
##########################################################################################

export MAVEN_PROJECTBASEDIR=${MAVEN_BASEDIR:-"$BASE_DIR"}
if [ "$MVNW_VERBOSE" = true ]; then
  echo $MAVEN_PROJECTBASEDIR
fi
MAVEN_OPTS="$(concat_lines "$MAVEN_PROJECTBASEDIR/.mvn/jvm.config") $MAVEN_OPTS"

# For Cygwin, switch paths to Windows format before running java
if $cygwin; then
  [ -n "$M2_HOME" ] &&
    M2_HOME=`cygpath --path --windows "$M2_HOME"`
  [ -n "$JAVA_HOME" ] &&
    JAVA_HOME=`cygpath --path --windows "$JAVA_HOME"`
  [ -n "$CLASSPATH" ] &&
    CLASSPATH=`cygpath --path --windows "$CLASSPATH"`
  [ -n "$MAVEN_PROJECTBASEDIR" ] &&
    MAVEN_PROJECTBASEDIR=`cygpath --path --windows "$MAVEN_PROJECTBASEDIR"`
fi

# Provide a "standardized" way to retrieve the CLI args that will
# work with both Windows and non-Windows executions.
MAVEN_CMD_LINE_ARGS="$MAVEN_CONFIG $@"
export MAVEN_CMD_LINE_ARGS

WRAPPER_LAUNCHER=org.apache.maven.wrapper.MavenWrapperMain

exec "$JAVACMD" \
  $MAVEN_OPTS \
  $MAVEN_DEBUG_OPTS \
  -classpath "$MAVEN_PROJECTBASEDIR/.mvn/wrapper/maven-wrapper.jar" \
  "-Dmaven.home=${M2_HOME}" \
  "-Dmaven.multiModuleProjectDirectory=${MAVEN_PROJECTBASEDIR}" \
  ${WRAPPER_LAUNCHER} $MAVEN_CONFIG "$@"

```

# mvnw.cmd

```cmd
@REM ----------------------------------------------------------------------------
@REM Licensed to the Apache Software Foundation (ASF) under one
@REM or more contributor license agreements.  See the NOTICE file
@REM distributed with this work for additional information
@REM regarding copyright ownership.  The ASF licenses this file
@REM to you under the Apache License, Version 2.0 (the
@REM "License"); you may not use this file except in compliance
@REM with the License.  You may obtain a copy of the License at
@REM
@REM    https://www.apache.org/licenses/LICENSE-2.0
@REM
@REM Unless required by applicable law or agreed to in writing,
@REM software distributed under the License is distributed on an
@REM "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
@REM KIND, either express or implied.  See the License for the
@REM specific language governing permissions and limitations
@REM under the License.
@REM ----------------------------------------------------------------------------

@REM ----------------------------------------------------------------------------
@REM Maven Start Up Batch script
@REM
@REM Required ENV vars:
@REM JAVA_HOME - location of a JDK home dir
@REM
@REM Optional ENV vars
@REM M2_HOME - location of maven2's installed home dir
@REM MAVEN_BATCH_ECHO - set to 'on' to enable the echoing of the batch commands
@REM MAVEN_BATCH_PAUSE - set to 'on' to wait for a keystroke before ending
@REM MAVEN_OPTS - parameters passed to the Java VM when running Maven
@REM     e.g. to debug Maven itself, use
@REM set MAVEN_OPTS=-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000
@REM MAVEN_SKIP_RC - flag to disable loading of mavenrc files
@REM ----------------------------------------------------------------------------

@REM Begin all REM lines with '@' in case MAVEN_BATCH_ECHO is 'on'
@echo off
@REM set title of command window
title %0
@REM enable echoing by setting MAVEN_BATCH_ECHO to 'on'
@if "%MAVEN_BATCH_ECHO%" == "on"  echo %MAVEN_BATCH_ECHO%

@REM set %HOME% to equivalent of $HOME
if "%HOME%" == "" (set "HOME=%HOMEDRIVE%%HOMEPATH%")

@REM Execute a user defined script before this one
if not "%MAVEN_SKIP_RC%" == "" goto skipRcPre
@REM check for pre script, once with legacy .bat ending and once with .cmd ending
if exist "%USERPROFILE%\mavenrc_pre.bat" call "%USERPROFILE%\mavenrc_pre.bat" %*
if exist "%USERPROFILE%\mavenrc_pre.cmd" call "%USERPROFILE%\mavenrc_pre.cmd" %*
:skipRcPre

@setlocal

set ERROR_CODE=0

@REM To isolate internal variables from possible post scripts, we use another setlocal
@setlocal

@REM ==== START VALIDATION ====
if not "%JAVA_HOME%" == "" goto OkJHome

echo.
echo Error: JAVA_HOME not found in your environment. >&2
echo Please set the JAVA_HOME variable in your environment to match the >&2
echo location of your Java installation. >&2
echo.
goto error

:OkJHome
if exist "%JAVA_HOME%\bin\java.exe" goto init

echo.
echo Error: JAVA_HOME is set to an invalid directory. >&2
echo JAVA_HOME = "%JAVA_HOME%" >&2
echo Please set the JAVA_HOME variable in your environment to match the >&2
echo location of your Java installation. >&2
echo.
goto error

@REM ==== END VALIDATION ====

:init

@REM Find the project base dir, i.e. the directory that contains the folder ".mvn".
@REM Fallback to current working directory if not found.

set MAVEN_PROJECTBASEDIR=%MAVEN_BASEDIR%
IF NOT "%MAVEN_PROJECTBASEDIR%"=="" goto endDetectBaseDir

set EXEC_DIR=%CD%
set WDIR=%EXEC_DIR%
:findBaseDir
IF EXIST "%WDIR%"\.mvn goto baseDirFound
cd ..
IF "%WDIR%"=="%CD%" goto baseDirNotFound
set WDIR=%CD%
goto findBaseDir

:baseDirFound
set MAVEN_PROJECTBASEDIR=%WDIR%
cd "%EXEC_DIR%"
goto endDetectBaseDir

:baseDirNotFound
set MAVEN_PROJECTBASEDIR=%EXEC_DIR%
cd "%EXEC_DIR%"

:endDetectBaseDir

IF NOT EXIST "%MAVEN_PROJECTBASEDIR%\.mvn\jvm.config" goto endReadAdditionalConfig

@setlocal EnableExtensions EnableDelayedExpansion
for /F "usebackq delims=" %%a in ("%MAVEN_PROJECTBASEDIR%\.mvn\jvm.config") do set JVM_CONFIG_MAVEN_PROPS=!JVM_CONFIG_MAVEN_PROPS! %%a
@endlocal & set JVM_CONFIG_MAVEN_PROPS=%JVM_CONFIG_MAVEN_PROPS%

:endReadAdditionalConfig

SET MAVEN_JAVA_EXE="%JAVA_HOME%\bin\java.exe"
set WRAPPER_JAR="%MAVEN_PROJECTBASEDIR%\.mvn\wrapper\maven-wrapper.jar"
set WRAPPER_LAUNCHER=org.apache.maven.wrapper.MavenWrapperMain

set DOWNLOAD_URL="https://repo.maven.apache.org/maven2/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"

FOR /F "usebackq tokens=1,2 delims==" %%A IN ("%MAVEN_PROJECTBASEDIR%\.mvn\wrapper\maven-wrapper.properties") DO (
    IF "%%A"=="wrapperUrl" SET DOWNLOAD_URL=%%B
)

@REM Extension to allow automatically downloading the maven-wrapper.jar from Maven-central
@REM This allows using the maven wrapper in projects that prohibit checking in binary data.
if exist %WRAPPER_JAR% (
    if "%MVNW_VERBOSE%" == "true" (
        echo Found %WRAPPER_JAR%
    )
) else (
    if not "%MVNW_REPOURL%" == "" (
        SET DOWNLOAD_URL="%MVNW_REPOURL%/org/apache/maven/wrapper/maven-wrapper/3.1.0/maven-wrapper-3.1.0.jar"
    )
    if "%MVNW_VERBOSE%" == "true" (
        echo Couldn't find %WRAPPER_JAR%, downloading it ...
        echo Downloading from: %DOWNLOAD_URL%
    )

    powershell -Command "&{"^
		"$webclient = new-object System.Net.WebClient;"^
		"if (-not ([string]::IsNullOrEmpty('%MVNW_USERNAME%') -and [string]::IsNullOrEmpty('%MVNW_PASSWORD%'))) {"^
		"$webclient.Credentials = new-object System.Net.NetworkCredential('%MVNW_USERNAME%', '%MVNW_PASSWORD%');"^
		"}"^
		"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; $webclient.DownloadFile('%DOWNLOAD_URL%', '%WRAPPER_JAR%')"^
		"}"
    if "%MVNW_VERBOSE%" == "true" (
        echo Finished downloading %WRAPPER_JAR%
    )
)
@REM End of extension

@REM Provide a "standardized" way to retrieve the CLI args that will
@REM work with both Windows and non-Windows executions.
set MAVEN_CMD_LINE_ARGS=%*

%MAVEN_JAVA_EXE% ^
  %JVM_CONFIG_MAVEN_PROPS% ^
  %MAVEN_OPTS% ^
  %MAVEN_DEBUG_OPTS% ^
  -classpath %WRAPPER_JAR% ^
  "-Dmaven.multiModuleProjectDirectory=%MAVEN_PROJECTBASEDIR%" ^
  %WRAPPER_LAUNCHER% %MAVEN_CONFIG% %*
if ERRORLEVEL 1 goto error
goto end

:error
set ERROR_CODE=1

:end
@endlocal & set ERROR_CODE=%ERROR_CODE%

if not "%MAVEN_SKIP_RC%"=="" goto skipRcPost
@REM check for post script, once with legacy .bat ending and once with .cmd ending
if exist "%USERPROFILE%\mavenrc_post.bat" call "%USERPROFILE%\mavenrc_post.bat"
if exist "%USERPROFILE%\mavenrc_post.cmd" call "%USERPROFILE%\mavenrc_post.cmd"
:skipRcPost

@REM pause the script if MAVEN_BATCH_PAUSE is set to 'on'
if "%MAVEN_BATCH_PAUSE%"=="on" pause

if "%MAVEN_TERMINATE_CMD%"=="on" exit %ERROR_CODE%

cmd /C exit /B %ERROR_CODE%

```

# package.json

```json
{
  "dependencies": {
    "ai-digest": "^1.0.7"
  }
}

```

# pom.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.cineplex</groupId>
  <artifactId>cineplex</artifactId>
  <version>1.0-SNAPSHOT</version>
  <name>cineplex</name>
  <packaging>war</packaging>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <maven.compiler.target>11</maven.compiler.target>
    <maven.compiler.source>11</maven.compiler.source>
    <junit.version>5.9.2</junit.version>
  </properties>

  <dependencies>
<dependency>
      <groupId>jakarta.servlet</groupId>
      <artifactId>jakarta.servlet-api</artifactId>
      <version>5.0.0</version>
      <scope>provided</scope>
    </dependency>
<dependency>
      <groupId>org.junit.jupiter</groupId>
      <artifactId>junit-jupiter-api</artifactId>
      <version>${junit.version}</version>
      <scope>test</scope>
    </dependency>
      <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter-engine</artifactId>
        <version>${junit.version}</version>
        <scope>test</scope>
      </dependency>

      <dependency>
          <groupId>com.mysql</groupId>
          <artifactId>mysql-connector-j</artifactId>
          <version>9.0.0</version>
      </dependency>
      <dependency>
          <groupId>com.vaadin.external.google</groupId>
          <artifactId>android-json</artifactId>
          <version>0.0.20131108.vaadin1</version>
      </dependency>
      <dependency>
          <groupId>javax.servlet</groupId>
          <artifactId>javax.servlet-api</artifactId>
          <version>3.1.0</version>
      </dependency>


  </dependencies>

  <build>
    <plugins>
<plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>3.3.2</version>
      </plugin>    </plugins>
  </build>
</project>
```

# src\main\java\com\cineplex\cineplex\controller\FilmManagement.java

```java
package com.cineplex.cineplex.controller;

import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.dao.DAOFactory;
import com.cineplex.cineplex.model.dao.FilmDAO;
import com.cineplex.cineplex.services.config.Configuration;
import com.cineplex.cineplex.services.logservice.LogService;

import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.util.logging.Level;

public class FilmManagement {

    public static void viewFilm(HttpServletRequest request, HttpServletResponse response) {
        DAOFactory daoFactory = null;

        try {
            daoFactory = DAOFactory.getDAOFactory(Configuration.DAO_IMPL, null);
            daoFactory.beginTransaction();

            FilmDAO filmDAO = daoFactory.getFilmDAO();
            String filmIdStr = request.getParameter("filmId");

            if (filmIdStr != null && !filmIdStr.isEmpty()) {
                int filmId = Integer.parseInt(filmIdStr);
                Film film = filmDAO.FindById(filmId);

                if (film != null) {
                    request.setAttribute("film", film);
                    request.setAttribute("viewUrl", "filmManagement/film");
                } else {
                    request.setAttribute("viewUrl", "homeManagement/view");
                    request.setAttribute("errorMessage", "Film not found");
                }
            } else {
                request.setAttribute("viewUrl", "homeManagement/view");
                request.setAttribute("errorMessage", "Invalid film ID");
            }

            daoFactory.commitTransaction();

        } catch (Exception e) {
            LogService.getApplicationLogger().log(Level.SEVERE, "Controller Error", e);
            try {
                if (daoFactory != null) daoFactory.rollbackTransaction();
            } catch (Throwable t) {
            }
            throw new RuntimeException(e);
        } finally {
            try {
                if (daoFactory != null) daoFactory.closeTransaction();
            } catch (Throwable t) {
            }
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\controller\HomeManagement.java

```java
package com.cineplex.cineplex.controller;

import com.cineplex.cineplex.model.dao.FilmDAO;
import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.mo.Utente;
import com.cineplex.cineplex.model.dao.DAOFactory;
import com.cineplex.cineplex.model.dao.UtenteDAO;
import com.cineplex.cineplex.services.config.Configuration;
import com.cineplex.cineplex.services.logservice.LogService;

import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import jakarta.servlet.http.Cookie;

import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;

public class HomeManagement {

    public static void view(HttpServletRequest request, HttpServletResponse response) {
        DAOFactory sessionDAOFactory = null;
        DAOFactory daoFactory = null;

        try {
            Map sessionFactoryParameters = new HashMap<String, Object>();
            sessionFactoryParameters.put("request", request);
            sessionFactoryParameters.put("response", response);
            sessionDAOFactory = DAOFactory.getDAOFactory(Configuration.COOKIE_IMPL, sessionFactoryParameters);
            sessionDAOFactory.beginTransaction();

            daoFactory = DAOFactory.getDAOFactory(Configuration.DAO_IMPL, null);
            daoFactory.beginTransaction();

            // Check for loggedUser cookie and set loggedOn attribute
            Cookie[] cookies = request.getCookies();
            boolean isLoggedOn = false;
            if (cookies != null) {
                for (Cookie cookie : cookies) {
                    if (cookie.getName().equals("loggedUser") && !cookie.getValue().isEmpty()) {
                        isLoggedOn = true;
                        break;
                    }
                }
            }
            request.setAttribute("loggedOn", isLoggedOn);

            // Fetch all films
            FilmDAO filmDAO = daoFactory.getFilmDAO();
            List<Film> films = filmDAO.findAll();
            System.out.println("Debug: Number of films fetched: " + films.size());
            for (Film film : films) {
                System.out.println("Debug: Film " + film.getTitolo() + " - percorsoLocandina: " + film.getPercorsoLocandina());
            }
            request.setAttribute("films", films);

            daoFactory.commitTransaction();
            sessionDAOFactory.commitTransaction();

            request.setAttribute("viewUrl", "homeManagement/view");

        } catch (Exception e) {
            LogService.getApplicationLogger().log(Level.SEVERE, "Controller Error", e);
            try {
                if (daoFactory != null) daoFactory.rollbackTransaction();
                if (sessionDAOFactory != null) sessionDAOFactory.rollbackTransaction();
            } catch (Throwable t) {
            }
            throw new RuntimeException(e);
        } finally {
            try {
                if (daoFactory != null) daoFactory.closeTransaction();
                if (sessionDAOFactory != null) sessionDAOFactory.closeTransaction();
            } catch (Throwable t) {
            }
        }
    }

    public static void loginView(HttpServletRequest request, HttpServletResponse response) {
        request.setAttribute("viewUrl", "homeManagement/login");
    }

    public static void login(HttpServletRequest request, HttpServletResponse response) {
        DAOFactory sessionDAOFactory = null;
        DAOFactory daoFactory = null;
        String applicationMessage = null;

        try {
            Map<String, Object> sessionFactoryParameters = new HashMap<>();
            sessionFactoryParameters.put("request", request);
            sessionFactoryParameters.put("response", response);
            sessionDAOFactory = DAOFactory.getDAOFactory(Configuration.COOKIE_IMPL, sessionFactoryParameters);
            sessionDAOFactory.beginTransaction();

            daoFactory = DAOFactory.getDAOFactory(Configuration.DAO_IMPL, null);
            daoFactory.beginTransaction();

            String username = request.getParameter("username");
            String password = request.getParameter("password");

            UtenteDAO utenteDAO = daoFactory.getUtenteDAO();
            Utente utente = utenteDAO.authenticate(username, password);

            if (utente != null) {
                HttpSession session = request.getSession(true);
                session.setAttribute("loggedUser", utente);
                request.setAttribute("loggedOn", true);

                UtenteDAO sessionUserDAO = sessionDAOFactory.getUtenteDAO();
                Utente existingUser = sessionUserDAO.findLoggedUser();

                if (existingUser != null) {
                    sessionUserDAO.update(utente);
                } else {
                    sessionUserDAO.create(
                            utente.getIdUtente(),
                            utente.getNome(),
                            utente.getCognome(),
                            utente.getUsername(),
                            utente.getEmail(),
                            utente.getPassword(),
                            utente.isNewsletter(),
                            utente.getTipo()
                    );
                }

                request.setAttribute("loginSuccess", true);
                request.setAttribute("viewUrl", "homeManagement/view");
            } else {
                request.setAttribute("loginError", true);
                request.setAttribute("viewUrl", "homeManagement/login");
            }

            daoFactory.commitTransaction();
            sessionDAOFactory.commitTransaction();

        } catch (Exception e) {
            LogService.getApplicationLogger().log(Level.SEVERE, "Controller Error", e);
            try {
                if (daoFactory != null) daoFactory.rollbackTransaction();
                if (sessionDAOFactory != null) sessionDAOFactory.rollbackTransaction();
            } catch (Throwable t) {
                // Log this exception
            }
            throw new RuntimeException(e);
        } finally {
            try {
                if (daoFactory != null) daoFactory.closeTransaction();
                if (sessionDAOFactory != null) sessionDAOFactory.closeTransaction();
            } catch (Throwable t) {
                // Log this exception
            }
        }
    }

    public static void signup(HttpServletRequest request, HttpServletResponse response) {
        DAOFactory sessionDAOFactory = null;
        DAOFactory daoFactory = null;

        try {
            Map sessionFactoryParameters = new HashMap<String, Object>();
            sessionFactoryParameters.put("request", request);
            sessionFactoryParameters.put("response", response);
            sessionDAOFactory = DAOFactory.getDAOFactory(Configuration.COOKIE_IMPL, sessionFactoryParameters);
            sessionDAOFactory.beginTransaction();

            daoFactory = DAOFactory.getDAOFactory(Configuration.DAO_IMPL, null);
            daoFactory.beginTransaction();

            String nome = request.getParameter("nome");
            String cognome = request.getParameter("cognome");
            String email = request.getParameter("email");
            String username = request.getParameter("username");
            String password = request.getParameter("password");
            boolean newsletter = request.getParameter("newsletter") != null;

            UtenteDAO utenteDAO = daoFactory.getUtenteDAO();

            // Perform checks
            if (nome == null || nome.trim().isEmpty() || nome.length() > 50) {
                request.setAttribute("signupError", "Nome is required and must be 50 characters or less");
                request.setAttribute("viewUrl", "homeManagement/login");
                return;
            }

            if (cognome == null || cognome.trim().isEmpty() || cognome.length() > 50) {
                request.setAttribute("signupError", "Cognome is required and must be 50 characters or less");
                request.setAttribute("viewUrl", "homeManagement/login");
                return;
            }

            if (email == null || email.trim().isEmpty() || email.length() > 100 || !isValidEmail(email)) {
                request.setAttribute("signupError", "Valid email is required and must be 100 characters or less");
                request.setAttribute("viewUrl", "homeManagement/login");
                return;
            }

            if (username == null || username.trim().isEmpty() || username.length() > 45) {
                request.setAttribute("signupError", "Username is required and must be 45 characters or less");
                request.setAttribute("viewUrl", "homeManagement/login");
                return;
            }

            if (password == null || password.trim().isEmpty() || password.length() > 255) {
                request.setAttribute("signupError", "Password is required and must be 255 characters or less");
                request.setAttribute("viewUrl", "homeManagement/login");
                return;
            }

            if (utenteDAO.FindByEmail(email) != null) {
                request.setAttribute("signupError", "Email already exists");
                request.setAttribute("viewUrl", "homeManagement/login");
                return;
            }

            if (utenteDAO.FindByUsername(username) != null) {
                request.setAttribute("signupError", "Username already exists");
                request.setAttribute("viewUrl", "homeManagement/login");
                return;
            }

            try {
                Utente newUtente = utenteDAO.create(null, nome, cognome, username, email, password, newsletter, "normale");

                HttpSession session = request.getSession(true);
                session.setAttribute("loggedUser", newUtente);
                request.setAttribute("loggedOn", true);

                UtenteDAO sessionUserDAO = sessionDAOFactory.getUtenteDAO();
                sessionUserDAO.create(
                        newUtente.getIdUtente(),
                        newUtente.getNome(),
                        newUtente.getCognome(),
                        newUtente.getUsername(),
                        newUtente.getEmail(),
                        newUtente.getPassword(),
                        newUtente.isNewsletter(),
                        newUtente.getTipo()
                );

                request.setAttribute("signupSuccess", true);
                request.setAttribute("viewUrl", "homeManagement/view");
            } catch (Exception e) {
                request.setAttribute("signupError", "Error during registration: " + e.getMessage());
                request.setAttribute("viewUrl", "homeManagement/login");
            }

            daoFactory.commitTransaction();
            sessionDAOFactory.commitTransaction();

        } catch (Exception e) {
            LogService.getApplicationLogger().log(Level.SEVERE, "Controller Error", e);
            try {
                if (daoFactory != null) daoFactory.rollbackTransaction();
                if (sessionDAOFactory != null) sessionDAOFactory.rollbackTransaction();
            } catch (Throwable t) {
            }
            throw new RuntimeException(e);
        } finally {
            try {
                if (daoFactory != null) daoFactory.closeTransaction();
                if (sessionDAOFactory != null) sessionDAOFactory.closeTransaction();
            } catch (Throwable t) {
            }
        }
    }

    // Helper method to validate email format
    private static boolean isValidEmail(String email) {
        String emailRegex = "^[a-zA-Z0-9_+&*-]+(?:\\.[a-zA-Z0-9_+&*-]+)*@(?:[a-zA-Z0-9-]+\\.)+[a-zA-Z]{2,7}$";
        return email.matches(emailRegex);
    }

    public static void logout(HttpServletRequest request, HttpServletResponse response) {

        DAOFactory sessionDAOFactory = null;
        Logger logger = LogService.getApplicationLogger();

        try {
            Map sessionFactoryParameters = new HashMap<String, Object>();
            sessionFactoryParameters.put("request", request);
            sessionFactoryParameters.put("response", response);
            sessionDAOFactory = DAOFactory.getDAOFactory(Configuration.COOKIE_IMPL, sessionFactoryParameters);
            sessionDAOFactory.beginTransaction();

            UtenteDAO sessionUserDAO = sessionDAOFactory.getUtenteDAO();

            // Delete the user cookie
            sessionUserDAO.delete(null);

            // Manually delete the LoggedUser cookie
            Cookie cookie = new Cookie("LoggedUser", "");
            cookie.setMaxAge(0);
            cookie.setPath("/");
            response.addCookie(cookie);

            // Invalidate the session
            HttpSession session = request.getSession(false);
            if (session != null) {
                session.invalidate();
            }

            sessionDAOFactory.commitTransaction();

            // Clear session attributes
            request.setAttribute("loggedOn", false);
            request.setAttribute("loggedUser", null);

            // Set view url for redirection
            request.setAttribute("viewUrl", "homeManagement/view");

        } catch (Exception e) {
            logger.log(Level.SEVERE, "Controller Error", e);
            try {
                if (sessionDAOFactory != null) sessionDAOFactory.rollbackTransaction();
            } catch (Throwable t) {
                // Log this exception as well
                logger.log(Level.SEVERE, "Rollback Error", t);
            }
            throw new RuntimeException(e);

        } finally {
            try {
                if (sessionDAOFactory != null) sessionDAOFactory.closeTransaction();
            } catch (Throwable t) {
                // Log this exception
                logger.log(Level.SEVERE, "Close Transaction Error", t);
            }
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\dispatcher\Dispatcher.java

```java
package com.cineplex.cineplex.dispatcher;

import java.io.IOException;
import java.io.PrintWriter;
import java.lang.reflect.Method;
import java.rmi.ServerException;
import java.util.logging.Level;
import jakarta.servlet.RequestDispatcher;
import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.annotation.MultipartConfig;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import com.cineplex.cineplex.services.logservice.LogService;

@WebServlet(name = "Dispatcher", urlPatterns = {"/Dispatcher"})
@MultipartConfig
public class Dispatcher extends HttpServlet {

    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();
        try {

            String controllerAction=request.getParameter("controllerAction");

            if (controllerAction==null) controllerAction="HomeManagement.view";

            String[] splittedAction=controllerAction.split("\\.");
            Class<?> controllerClass = Class.forName("com.cineplex.cineplex.controller." + splittedAction[0]);
            Method controllerMethod=controllerClass.getMethod(splittedAction[1],HttpServletRequest.class,HttpServletResponse.class);
            LogService.getApplicationLogger().log(Level.INFO,splittedAction[0]+" "+splittedAction[1]);
            controllerMethod.invoke(null,request,response);

            String viewUrl=(String)request.getAttribute("viewUrl");
            RequestDispatcher view=request.getRequestDispatcher("jsp/"+viewUrl+".jsp");
            view.forward(request,response);


        } catch (Exception e) {
            e.printStackTrace(out);
            throw new ServerException("Dispacther Servlet Error",e);

        } finally {
            out.close();
        }
    }

    // <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
    /**
     * Handles the HTTP
     * <code>GET</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    /**
     * Handles the HTTP
     * <code>POST</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        processRequest(request, response);
    }

    /**
     * Returns a short description of the servlet.
     *
     * @return a String containing servlet description
     */
    @Override
    public String getServletInfo() {
        return "Short description";
    }// </editor-fold>
}


```

# src\main\java\com\cineplex\cineplex\model\dao\AbbonamentoDAO.java

```java
package com.cineplex.cineplex.model.dao;

import java.util.Date;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.TipoAbbonamento;
import com.cineplex.cineplex.model.mo.Utente;

import java.util.Date;

public interface AbbonamentoDAO {

        public Abbonamento create(
                Integer idAbbonamento,
                Date dataSottoscrizione,
                Utente utenteId,
                TipoAbbonamento tipoAbbonamentoId
        );

        public void update(Abbonamento abbonamento);

        public void delete(Abbonamento abbonamento);

        public Abbonamento FindById(Integer idAbbonamento);


        public Abbonamento FindByUserId(Utente utente);

        public Abbonamento FindByDate(Date dataSottoscrizione);



}

```

# src\main\java\com\cineplex\cineplex\model\dao\BigliettoDAO.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.BigliettoDAOMySQLJDBCImpl.DuplicateSeatException;
import com.cineplex.cineplex.model.mo.Biglietto;
import com.cineplex.cineplex.model.mo.Proiezione;
import com.cineplex.cineplex.model.mo.Utente;

public interface BigliettoDAO {
        Biglietto create(Integer idBiglietto, String posto, Boolean ingressoAbbonamento, Utente utente, Proiezione proiezione)
                throws DuplicateSeatException;

        void update(Biglietto biglietto) throws DuplicateSeatException;

        public void delete(Biglietto biglietto);

        public Biglietto FindById(Integer idBiglietto);

        public Biglietto FindByUserId(Utente utente);

        public Biglietto FindByProiezione(Proiezione proiezione);


}

```

# src\main\java\com\cineplex\cineplex\model\dao\CookieImpl\AbbonamentoDAOCookieImpl.java

```java
package com.cineplex.cineplex.model.dao.CookieImpl;

import com.cineplex.cineplex.model.dao.AbbonamentoDAO;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.TipoAbbonamento;
import com.cineplex.cineplex.model.mo.Utente;
import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

public class AbbonamentoDAOCookieImpl implements AbbonamentoDAO {

    private HttpServletRequest request;
    private HttpServletResponse response;

    public AbbonamentoDAOCookieImpl(HttpServletRequest request, HttpServletResponse response) {
        this.request = request;
        this.response = response;
    }

    @Override
    public Abbonamento create(Integer idAbbonamento, Date dataSottoscrizione, Utente utenteId, TipoAbbonamento tipoAbbonamentoId) {
        Abbonamento abbonamento = new Abbonamento(idAbbonamento, dataSottoscrizione, utenteId, tipoAbbonamentoId, false);
        String encodedAbbonamento = encode(abbonamento);
        Cookie cookie = new Cookie("abbonamento", encodedAbbonamento);
        cookie.setMaxAge(24 * 60 * 60); // 1 day
        response.addCookie(cookie);
        return abbonamento;
    }

    @Override
    public void update(Abbonamento abbonamento) {
        String encodedAbbonamento = encode(abbonamento);
        Cookie cookie = new Cookie("abbonamento", encodedAbbonamento);
        cookie.setMaxAge(24 * 60 * 60); // 1 day
        response.addCookie(cookie);
    }

    @Override
    public void delete(Abbonamento abbonamento) {
        Cookie cookie = new Cookie("abbonamento", "");
        cookie.setMaxAge(0);
        response.addCookie(cookie);
    }

    @Override
    public Abbonamento FindById(Integer idAbbonamento) {
        Cookie[] cookies = request.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if (cookie.getName().equals("abbonamento")) {
                    Abbonamento abbonamento = decode(cookie.getValue());
                    if (abbonamento.getIdAbbonamento() == idAbbonamento) {
                        return abbonamento;
                    }
                }
            }
        }
        return null;
    }

    @Override
    public Abbonamento FindByUserId(Utente utente) {
        Cookie[] cookies = request.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if (cookie.getName().equals("abbonamento")) {
                    Abbonamento abbonamento = decode(cookie.getValue());
                    if (abbonamento.getUtenteId().getIdUtente() == utente.getIdUtente()) {
                        return abbonamento;
                    }
                }
            }
        }
        return null;
    }

    @Override
    public Abbonamento FindByDate(Date dataSottoscrizione) {
        Cookie[] cookies = request.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if (cookie.getName().equals("abbonamento")) {
                    Abbonamento abbonamento = decode(cookie.getValue());
                    if (abbonamento.getDataSottoscrizione().equals(dataSottoscrizione)) {
                        return abbonamento;
                    }
                }
            }
        }
        return null;
    }

    private String encode(Abbonamento abbonamento) {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
        return abbonamento.getIdAbbonamento() + "#" +
                sdf.format(abbonamento.getDataSottoscrizione()) + "#" +
                abbonamento.getUtenteId().getIdUtente() + "#" +
                abbonamento.getTipoAbbonamentoId().getIdTipoAbbonamento();
    }

    private Abbonamento decode(String encodedAbbonamento) {
        String[] values = encodedAbbonamento.split("#");
        if (values.length >= 4) {
            try {
                int idAbbonamento = Integer.parseInt(values[0]);
                SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
                Date dataSottoscrizione = sdf.parse(values[1]);
                Utente utente = new Utente();
                utente.setIdUtente(Integer.parseInt(values[2]));
                TipoAbbonamento tipoAbbonamento = new TipoAbbonamento();
                tipoAbbonamento.setIdTipoAbbonamento(Integer.parseInt(values[3]));
                return new Abbonamento(idAbbonamento, dataSottoscrizione, utente, tipoAbbonamento, false);
            } catch (ParseException e) {
                e.printStackTrace();
            }
        }
        return null;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\CookieImpl\CookieDAOFactory.java

```java
package com.cineplex.cineplex.model.dao.CookieImpl;

import com.cineplex.cineplex.model.dao.*;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

import java.util.Map;

public class CookieDAOFactory extends DAOFactory{

    private Map factoryPrameters;

    private HttpServletRequest request;
    private HttpServletResponse response;


    public CookieDAOFactory(Map factoryPrameters){this.factoryPrameters = factoryPrameters;}

    @Override
    public void beginTransaction() {

        try {
            this.request = (HttpServletRequest) factoryPrameters.get("request");
            this.response = (HttpServletResponse) factoryPrameters.get("response");
        } catch(Exception e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void commitTransaction() {}

    @Override
    public void rollbackTransaction() {}

    @Override
    public void closeTransaction() {}

    @Override
    public AbbonamentoDAO getAbbonamentoDAO() {
        return null;
    }

    @Override
    public BigliettoDAO getBigliettoDAO() {
        return null;
    }

    @Override
    public FilmDAO getFilmDAO() {
        return null;
    }

    @Override
    public GenereDAO getGenereDAO() {
        return null;
    }

    @Override
    public ProiezioneDAO getProiezioneDAO() {
        return null;
    }

    @Override
    public RecensioneDAO getRecensioneDAO() {
        return null;
    }

    @Override
    public TipoAbbonamentoDAO getTipoAbbonamentoDAO() {
        return null;
    }

    @Override
    public UtenteDAO getUtenteDAO() {
        return new UtenteDAOCookieImpl(request,response);
    }





}

```

# src\main\java\com\cineplex\cineplex\model\dao\CookieImpl\UtenteDAOCookieImpl.java

```java
package com.cineplex.cineplex.model.dao.CookieImpl;

import com.cineplex.cineplex.model.dao.UtenteDAO;
import com.cineplex.cineplex.model.mo.Utente;
import jakarta.servlet.http.Cookie;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;

public class UtenteDAOCookieImpl implements UtenteDAO {

    HttpServletRequest request;
    HttpServletResponse response;

    public UtenteDAOCookieImpl(HttpServletRequest request, HttpServletResponse response) {
        this.request = request;
        this.response = response;
    }

    @Override
    public Utente create(Integer idUtente, String nome, String cognome, String username, String email, String password, Boolean newsletter, String tipo) {
        Utente loggedUser = new Utente();
        loggedUser.setIdUtente(idUtente);
        loggedUser.setUsername(username);
        loggedUser.setNewsletter(newsletter);
        loggedUser.setTipo(tipo);

        setCookie(loggedUser);

        return loggedUser;
    }

    @Override
    public Utente authenticate(String username, String password) {
        return null;
    }

    @Override
    public void update(Utente utente) {
        setCookie(utente);
    }

    @Override
    public void delete(Utente loggedUser) {
        Cookie cookie = new Cookie("loggedUser", "");
        cookie.setMaxAge(0);
        cookie.setPath("/");
        response.addCookie(cookie);
    }

    @Override
    public void banUtente(int idUtente) {

    }

    @Override
    public void unbanUtente(int idUtente) {

    }

    public Utente findLoggedUser() {
        Cookie[] cookies = request.getCookies();
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if (cookie.getName().equals("loggedUser")) {
                    return decode(cookie.getValue());
                }
            }
        }
        return null;
    }

    @Override
    public Utente FindById(Integer idUtente) {
        return null;
    }

    @Override
    public Utente FindByUsername(String username) {
        return null;
    }

    @Override
    public Utente FindByEmail(String email) {
        return null;
    }

    private void setCookie(Utente utente) {
        Cookie cookie = new Cookie("loggedUser", encode(utente));
        cookie.setMaxAge(3600); // 1 hour
        cookie.setPath("/");
        response.addCookie(cookie);
    }

    private String encode(Utente utente) {
        return utente.getIdUtente() + "#" + utente.getUsername() + "#" + utente.isNewsletter() + "#" + utente.getTipo();
    }

    private Utente decode(String encodedLoggedUser) {
        Utente utente = new Utente();
        String[] values = encodedLoggedUser.split("#");
        if (values.length >= 4) {
            utente.setIdUtente(Integer.parseInt(values[0]));
            utente.setUsername(values[1]);
            utente.setNewsletter(Boolean.parseBoolean(values[2]));
            utente.setTipo(values[3]);
        }
        return utente;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\DAOFactory.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.dao.CookieImpl.CookieDAOFactory;
import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.MySQLJDBCDAOFactory;

import java.util.Map;

public abstract class DAOFactory {

    // List of DAO types supported by the factory
    public static final String MYSQLJDBCIMPL = "MySQLJDBCImpl";
    public static final String COOKIEIMPL= "CookieImpl";

    public abstract void beginTransaction();
    public abstract void commitTransaction();
    public abstract void rollbackTransaction();
    public abstract void closeTransaction();

    public abstract AbbonamentoDAO getAbbonamentoDAO();

    public abstract BigliettoDAO getBigliettoDAO();

    public abstract FilmDAO getFilmDAO();


    public abstract GenereDAO getGenereDAO();

    public abstract ProiezioneDAO getProiezioneDAO();

    public abstract RecensioneDAO getRecensioneDAO();

    public abstract TipoAbbonamentoDAO getTipoAbbonamentoDAO();

    public abstract UtenteDAO getUtenteDAO();

    public static DAOFactory getDAOFactory(String whichFactory,Map factoryParameters) {

        if (whichFactory.equals(MYSQLJDBCIMPL)) {
            return new MySQLJDBCDAOFactory(factoryParameters);
        } else if (whichFactory.equals(COOKIEIMPL)) {
            return new CookieDAOFactory(factoryParameters);
        } else {
            return null;
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\exceptions\UserExceptions.java

```java
package com.cineplex.cineplex.model.dao.exceptions;

public class UserExceptions {

    public static class DuplicateUsernameException extends Exception {
        public DuplicateUsernameException(String message) {
            super(message);
        }
    }

    public static class DuplicateEmailException extends Exception {
        public DuplicateEmailException(String message) {
            super(message);
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\FilmDAO.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.FilmDAOMySQLJDBCImpl;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.mo.Genere;

import java.util.Date;
import java.util.List;

public interface FilmDAO {

    Film create(Integer idFilm, String titolo, Date dataInizioDisponibilita, Date dataFineDisponibilita,
                String percorsoLocandina, Date dataPubblicazione, Integer durataMinuti, String descrizione,
                String linkTrailerYT, String regista, List<Genere> generi) throws FilmDAOMySQLJDBCImpl.DuplicateTitleException;

    void update(Film film) throws FilmDAOMySQLJDBCImpl.DuplicateTitleException;

    public void delete(Film film);

    List<Film> findAll() throws Exception;

    public Film FindById(Integer idFilm);
    List<Film> FindByTitolo(String query) throws Exception;

    public List<Film> FindByGenere(List<Genere> generi);
}

```

# src\main\java\com\cineplex\cineplex\model\dao\GenereDAO.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.GenereDAOMySQLJDBCImpl;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.mo.Genere;

import java.util.List;

public interface GenereDAO {
        Genere create(int idGenere, String nomeGenere, List<Film> films) throws GenereDAOMySQLJDBCImpl.DuplicateGenreException;

        void update(Genere genere) throws GenereDAOMySQLJDBCImpl.DuplicateGenreException;


        public void delete(Genere genere);

        public Genere FindById(Integer idGenere);

        public List<Genere> FindByFilm(List<Film> films);

        public Genere FindByNomeGenere(String nomeGenere);
}

```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\AbbonamentoDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.AbbonamentoDAO;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.TipoAbbonamento;
import com.cineplex.cineplex.model.mo.Utente;

import java.sql.*;
import java.util.Date;

public class AbbonamentoDAOMySQLJDBCImpl implements AbbonamentoDAO {

    private Connection connection;

    public AbbonamentoDAOMySQLJDBCImpl(Connection connection) {
        this.connection = connection;
    }

    @Override
    public Abbonamento create(Integer idAbbonamento, Date dataSottoscrizione, Utente utenteId, TipoAbbonamento tipoAbbonamentoId) {
        PreparedStatement ps;
        Abbonamento abbonamento = new Abbonamento();
        try {
            String sql
                    = " INSERT INTO abbonamento"
                    + " (data_sottoscrizione, utente_id, tipo_abbonamento_id)"
                    + " VALUES (?,?,?)";

            ps = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            int i = 1;
            ps.setDate(i++, new java.sql.Date(dataSottoscrizione.getTime()));
            ps.setInt(i++, utenteId.getIdUtente());
            ps.setInt(i++, tipoAbbonamentoId.getIdTipoAbbonamento());

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idAbbonamento = rs.getInt(1);
            }

            abbonamento.setIdAbbonamento(idAbbonamento);
            abbonamento.setDataSottoscrizione(dataSottoscrizione);
            abbonamento.setUtenteId(utenteId);
            abbonamento.setTipoAbbonamentoId(tipoAbbonamentoId);
            abbonamento.setDeleted(false);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return abbonamento;
    }

    @Override
    public void update(Abbonamento abbonamento) {
        PreparedStatement ps;
        try {
            String sql
                    = " UPDATE abbonamento"
                    + " SET data_sottoscrizione = ?,"
                    + " utente_id = ?,"
                    + " tipo_abbonamento_id = ?,"
                    + " deleted = ?"
                    + " WHERE"
                    + " id_abbonamento = ?";

            ps = connection.prepareStatement(sql);
            int i = 1;
            ps.setDate(i++, new java.sql.Date(abbonamento.getDataSottoscrizione().getTime()));
            ps.setInt(i++, abbonamento.getUtenteId().getIdUtente());
            ps.setInt(i++, abbonamento.getTipoAbbonamentoId().getIdTipoAbbonamento());
            ps.setString(i++, abbonamento.isDeleted() ? "y" : "n");
            ps.setInt(i++, abbonamento.getIdAbbonamento());

            ps.executeUpdate();

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(Abbonamento abbonamento) {
        PreparedStatement ps;
        try {
            String sql
                    = " UPDATE abbonamento"
                    + " SET deleted = 'y'"
                    + " WHERE"
                    + " id_abbonamento = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, abbonamento.getIdAbbonamento());
            ps.executeUpdate();
            abbonamento.setDeleted(true);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }


    @Override
    public Abbonamento FindById(Integer idAbbonamento) {
        PreparedStatement ps;
        Abbonamento abbonamento = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM abbonamento"
                    + " WHERE"
                    + " id_abbonamento = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, idAbbonamento);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                abbonamento = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return abbonamento;
    }

    @Override
    public Abbonamento FindByUserId(Utente utente) {
        PreparedStatement ps;
        Abbonamento abbonamento = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM abbonamento"
                    + " WHERE"
                    + " utente_id = ?"
                    + " AND deleted = 'n'"
                    + " LIMIT 1";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, utente.getIdUtente());

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                abbonamento = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return abbonamento;
    }

    @Override
    public Abbonamento FindByDate(Date dataSottoscrizione) {
        return null;
    }

    private Abbonamento read(ResultSet rs) {
        Abbonamento abbonamento = new Abbonamento();
        try {
            abbonamento.setIdAbbonamento(rs.getInt("id_abbonamento"));
            abbonamento.setDataSottoscrizione(rs.getDate("data_sottoscrizione"));

            Utente utente = new Utente();
            utente.setIdUtente(rs.getInt("utente_id"));
            abbonamento.setUtenteId(utente);

            TipoAbbonamento tipoAbbonamento = new TipoAbbonamento();
            tipoAbbonamento.setIdTipoAbbonamento(rs.getInt("tipo_abbonamento_id"));
            abbonamento.setTipoAbbonamentoId(tipoAbbonamento);

            abbonamento.setDeleted(rs.getString("deleted").equals("y"));
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
        return abbonamento;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\BigliettoDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.BigliettoDAO;
import com.cineplex.cineplex.model.mo.Biglietto;
import com.cineplex.cineplex.model.mo.Proiezione;
import com.cineplex.cineplex.model.mo.Utente;

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

public class BigliettoDAOMySQLJDBCImpl implements BigliettoDAO {

    private Connection connection;

    public BigliettoDAOMySQLJDBCImpl(Connection connection) {
        this.connection = connection;
    }

    @Override
    public Biglietto create(Integer idBiglietto, String posto, Boolean ingressoAbbonamento, Utente utente, Proiezione proiezione)
            throws DuplicateSeatException {
        PreparedStatement ps;
        Biglietto biglietto = new Biglietto();
        try {
            // Check if the seat is already taken for this projection
            if (isSeatTaken(posto, proiezione.getIdProiezione())) {
                throw new DuplicateSeatException("Il posto " + posto + "  gi occupato per questa proiezione.");
            }

            String sql
                    = " INSERT INTO biglietto"
                    + " (posto, ingresso_abbonamento, utente_id, proiezione_id)"
                    + " VALUES (?,?,?,?)";

            ps = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            int i = 1;
            ps.setString(i++, posto);
            ps.setString(i++, ingressoAbbonamento ? "y" : "n");
            ps.setInt(i++, utente.getIdUtente());
            ps.setInt(i++, proiezione.getIdProiezione());

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idBiglietto = rs.getInt(1);
            }

            biglietto.setIdBiglietto(idBiglietto);
            biglietto.setPosto(posto);
            biglietto.setIngressoAbbonamento(ingressoAbbonamento);
            biglietto.setUtente(utente);
            biglietto.setProiezione(proiezione);
            biglietto.setDeleted(false);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return biglietto;
    }

    @Override
    public void update(Biglietto biglietto) throws DuplicateSeatException {
        PreparedStatement ps;
        try {
            // Check if the new seat is already taken for this projection
            if (isSeatTaken(biglietto.getPosto(), biglietto.getProiezione().getIdProiezione())) {
                throw new DuplicateSeatException("Il posto " + biglietto.getPosto() + "  gi occupato per questa proiezione.");
            }

            String sql
                    = " UPDATE biglietto"
                    + " SET posto = ?,"
                    + " ingresso_abbonamento = ?,"
                    + " utente_id = ?,"
                    + " proiezione_id = ?,"
                    + " deleted = ?"
                    + " WHERE"
                    + " id_biglietto = ?";

            ps = connection.prepareStatement(sql);
            int i = 1;
            ps.setString(i++, biglietto.getPosto());
            ps.setString(i++, biglietto.isIngressoAbbonamento() ? "y" : "n");
            ps.setInt(i++, biglietto.getUtente().getIdUtente());
            ps.setInt(i++, biglietto.getProiezione().getIdProiezione());
            ps.setString(i++, biglietto.isDeleted() ? "y" : "n");
            ps.setInt(i++, biglietto.getIdBiglietto());

            ps.executeUpdate();

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(Biglietto biglietto) {
        PreparedStatement ps;
        try {
            String sql
                    = " UPDATE biglietto"
                    + " SET deleted = 'y'"
                    + " WHERE"
                    + " id_biglietto = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, biglietto.getIdBiglietto());
            ps.executeUpdate();
            biglietto.setDeleted(true);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public Biglietto FindById(Integer idBiglietto) {
        PreparedStatement ps;
        Biglietto biglietto = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM biglietto"
                    + " WHERE"
                    + " id_biglietto = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, idBiglietto);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                biglietto = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return biglietto;
    }

    @Override
    public Biglietto FindByUserId(Utente utente) {
        PreparedStatement ps;
        Biglietto biglietto = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM biglietto"
                    + " WHERE"
                    + " utente_id = ?"
                    + " AND deleted = 'n'"
                    + " ORDER BY id_biglietto DESC"
                    + " LIMIT 1";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, utente.getIdUtente());

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                biglietto = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return biglietto;
    }

    @Override
    public Biglietto FindByProiezione(Proiezione proiezione) {
        PreparedStatement ps;
        Biglietto biglietto = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM biglietto"
                    + " WHERE"
                    + " proiezione_id = ?"
                    + " AND deleted = 'n'"
                    + " ORDER BY id_biglietto DESC"
                    + " LIMIT 1";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, proiezione.getIdProiezione());

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                biglietto = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return biglietto;
    }

    private Biglietto read(ResultSet rs) {
        Biglietto biglietto = new Biglietto();
        try {
            biglietto.setIdBiglietto(rs.getInt("id_biglietto"));
            biglietto.setPosto(rs.getString("posto"));
            biglietto.setIngressoAbbonamento(rs.getString("ingresso_abbonamento").equals("y"));

            Utente utente = new Utente();
            utente.setIdUtente(rs.getInt("utente_id"));
            biglietto.setUtente(utente);

            Proiezione proiezione = new Proiezione();
            proiezione.setIdProiezione(rs.getInt("proiezione_id"));
            biglietto.setProiezione(proiezione);

            biglietto.setDeleted(rs.getString("deleted").equals("y"));
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
        return biglietto;
    }

    private boolean isSeatTaken(String posto, int proiezioneId) throws SQLException {
        String sql = "SELECT COUNT(*) FROM biglietto WHERE posto = ? AND proiezione_id = ? AND deleted = 'n'";

        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setString(1, posto);
        ps.setInt(2, proiezioneId);

        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    public static class DuplicateSeatException extends Exception {
        public DuplicateSeatException(String message) {
            super(message);
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\FilmDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.DAOFactory;
import com.cineplex.cineplex.model.dao.FilmDAO;
import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.mo.Genere;

import java.sql.*;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;

public class FilmDAOMySQLJDBCImpl implements FilmDAO {

    private Connection connection;

    public FilmDAOMySQLJDBCImpl(Connection connection) {
        this.connection = connection;
    }

    @Override
    public Film create(Integer idFilm, String titolo, Date dataInizioDisponibilita, Date dataFineDisponibilita,
                       String percorsoLocandina, Date dataPubblicazione, Integer durataMinuti, String descrizione,
                       String linkTrailerYT, String regista, List<Genere> generi) throws DuplicateTitleException {

        PreparedStatement ps;
        Film film = new Film();
        try {
            // Check if the title already exists
            if (isTitleExist(titolo)) {
                throw new DuplicateTitleException("Il titolo del film '" + titolo + "' esiste gi.");
            }

            String sql = "INSERT INTO film (titolo, data_inizio_disponibilita, data_fine_disponibilita, " +
                    "percorso_locandina, data_pubblicazione, durata_minuti, descrizione, " +
                    "link_trailer_yt, regista) VALUES (?,?,?,?,?,?,?,?,?)";

            ps = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            int i = 1;
            ps.setString(i++, titolo);
            ps.setDate(i++, new java.sql.Date(dataInizioDisponibilita.getTime()));
            ps.setDate(i++, new java.sql.Date(dataFineDisponibilita.getTime()));
            ps.setString(i++, percorsoLocandina);
            ps.setDate(i++, new java.sql.Date(dataPubblicazione.getTime()));
            ps.setInt(i++, durataMinuti);
            ps.setString(i++, descrizione);
            ps.setString(i++, linkTrailerYT);
            ps.setString(i++, regista);

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idFilm = rs.getInt(1);
            }

            film.setIdFilm(idFilm);
            film.setTitolo(titolo);
            film.setDataInizioDisponibilita(dataInizioDisponibilita);
            film.setDataFineDisponibilita(dataFineDisponibilita);
            film.setPercorsoLocandina(percorsoLocandina);
            film.setDataPubblicazione(dataPubblicazione);
            film.setDurataMinuti(durataMinuti);
            film.setDescrizione(descrizione);
            film.setLinkTrailerYt(linkTrailerYT);
            film.setRegista(regista);
            film.setDeleted(false);
            film.setGeneri(generi);

            // Insert genres
            insertGenres(idFilm, generi);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return film;
    }

    @Override
    public void update(Film film) throws DuplicateTitleException {
        PreparedStatement ps;
        try {
            // Check if the new title already exists (excluding this film)
            if (isTitleExistExcludingThis(film.getTitolo(), film.getIdFilm())) {
                throw new DuplicateTitleException("Il titolo del film '" + film.getTitolo() + "' esiste gi.");
            }

            String sql = "UPDATE film SET titolo = ?, data_inizio_disponibilita = ?, " +
                    "data_fine_disponibilita = ?, percorso_locandina = ?, data_pubblicazione = ?, " +
                    "durata_minuti = ?, descrizione = ?, link_trailer_yt = ?, regista = ?, " +
                    "deleted = ? WHERE id_film = ?";

            ps = connection.prepareStatement(sql);
            int i = 1;
            ps.setString(i++, film.getTitolo());
            ps.setDate(i++, new java.sql.Date(film.getDataInizioDisponibilita().getTime()));
            ps.setDate(i++, new java.sql.Date(film.getDataFineDisponibilita().getTime()));
            ps.setString(i++, film.getPercorsoLocandina());
            ps.setDate(i++, new java.sql.Date(film.getDataPubblicazione().getTime()));
            ps.setInt(i++, film.getDurataMinuti());
            ps.setString(i++, film.getDescrizione());
            ps.setString(i++, film.getLinkTrailerYt());
            ps.setString(i++, film.getRegista());
            ps.setString(i++, film.getDeleted() ? "y" : "n");
            ps.setInt(i++, film.getIdFilm());

            ps.executeUpdate();

            // Update genres
            updateGenres(film.getIdFilm(), film.getGeneri());

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(Film film) {
        PreparedStatement ps;
        try {
            String sql = "UPDATE film SET deleted = 'y' WHERE id_film = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, film.getIdFilm());
            ps.executeUpdate();
            film.setDeleted(true);

            // Also delete from film_genere table
            deleteGenres(film.getIdFilm());

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public List<Film> findAll() throws Exception {
        List<Film> films = new ArrayList<>();
        PreparedStatement pstmt = null;
        ResultSet rs = null;

        try {
            String sql = "SELECT * FROM film WHERE deleted = 'n'";
            pstmt = connection.prepareStatement(sql);
            rs = pstmt.executeQuery();

            while (rs.next()) {
                Film film = read(rs);
                film.setGeneri(getGenresForFilm(film.getIdFilm()));
                films.add(film);
            }
        } finally {
            if (rs != null) rs.close();
            if (pstmt != null) pstmt.close();
        }

        return films;
    }

    @Override
    public Film FindById(Integer idFilm) {
        PreparedStatement ps;
        Film film = null;

        try {
            String sql = "SELECT * FROM film WHERE id_film = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, idFilm);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                film = read(resultSet);
                film.setGeneri(getGenresForFilm(idFilm));
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return film;
    }

    @Override
    public List<Film> FindByTitolo(String query) throws Exception {
        List<Film> films = new ArrayList<>();
        try {
            String sql = "SELECT * FROM film WHERE titolo LIKE ? AND deleted = 'n'";
            PreparedStatement statement = connection.prepareStatement(sql);
            statement.setString(1, "%" + query + "%");
            ResultSet resultSet = statement.executeQuery();
            while (resultSet.next()) {
                Film film = read(resultSet);
                film.setGeneri(getGenresForFilm(film.getIdFilm()));
                films.add(film);
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        return films;
    }

    @Override
    public List<Film> FindByGenere(List<Genere> generi) {
        PreparedStatement ps;
        List<Film> films = new ArrayList<>();

        try {
            StringBuilder sql = new StringBuilder(
                    "SELECT DISTINCT f.* FROM film f " +
                            "JOIN film_genere fg ON f.id_film = fg.film_id " +
                            "WHERE f.deleted = 'n' AND fg.genere_id IN ("
            );
            for (int i = 0; i < generi.size(); i++) {
                sql.append(i > 0 ? "," : "").append("?");
            }
            sql.append(")");

            ps = connection.prepareStatement(sql.toString());
            int paramIndex = 1;
            for (Genere genere : generi) {
                ps.setInt(paramIndex++, genere.getIdGenere());
            }

            ResultSet resultSet = ps.executeQuery();

            while (resultSet.next()) {
                Film film = read(resultSet);
                film.setGeneri(getGenresForFilm(film.getIdFilm()));
                films.add(film);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return films;
    }

    private Film read(ResultSet rs) throws SQLException {
        Film film = new Film();
        film.setIdFilm(rs.getInt("id_film"));
        film.setTitolo(rs.getString("titolo"));
        film.setDataInizioDisponibilita(rs.getDate("data_inizio_disponibilita"));
        film.setDataFineDisponibilita(rs.getDate("data_fine_disponibilita"));
        String percorsoLocandina = rs.getString("percorso_locandina");
        film.setPercorsoLocandina(percorsoLocandina);
        film.setDataPubblicazione(rs.getDate("data_pubblicazione"));
        film.setDurataMinuti(rs.getInt("durata_minuti"));
        film.setDescrizione(rs.getString("descrizione"));
        film.setLinkTrailerYt(rs.getString("link_trailer_yt"));
        film.setRegista(rs.getString("regista"));
        film.setDeleted(rs.getString("deleted").equals("y"));
        return film;
    }

    private boolean isTitleExist(String titolo) throws SQLException {
        PreparedStatement ps = connection.prepareStatement("SELECT COUNT(*) FROM film WHERE titolo = ? AND deleted = 'n'");
        ps.setString(1, titolo);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    private boolean isTitleExistExcludingThis(String titolo, int filmId) throws SQLException {
        PreparedStatement ps = connection.prepareStatement("SELECT COUNT(*) FROM film WHERE titolo = ? AND id_film != ? AND deleted = 'n'");
        ps.setString(1, titolo);
        ps.setInt(2, filmId);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    private void insertGenres(int filmId, List<Genere> generi) throws SQLException {
        String sql = "INSERT INTO film_genere (film_id, genere_id) VALUES (?, ?)";
        PreparedStatement ps = connection.prepareStatement(sql);
        for (Genere genere : generi) {
            ps.setInt(1, filmId);
            ps.setInt(2, genere.getIdGenere());
            ps.addBatch();
        }
        ps.executeBatch();
    }

    private void updateGenres(int filmId, List<Genere> generi) throws SQLException {
        // First, delete all existing genres for this film
        deleteGenres(filmId);
        // Then, insert the new genres
        insertGenres(filmId, generi);
    }

    private void deleteGenres(int filmId) throws SQLException {
        String sql = "DELETE FROM film_genere WHERE film_id = ?";
        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setInt(1, filmId);
        ps.executeUpdate();
    }

    private List<Genere> getGenresForFilm(int filmId) throws SQLException {
        List<Genere> generi = new ArrayList<>();
        String sql = "SELECT g.* FROM genere g JOIN film_genere fg ON g.id_genere = fg.genere_id WHERE fg.film_id = ?";
        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setInt(1, filmId);
        ResultSet rs = ps.executeQuery();
        while (rs.next()) {
            Genere genere = new Genere();
            genere.setIdGenere(rs.getInt("id_genere"));
            genere.setNomeGenere(rs.getString("nome_genere"));
            genere.setDeleted(rs.getString("deleted").equals("y"));
            generi.add(genere);
        }
        return generi;
    }

    public static class DuplicateTitleException extends Exception {
        public DuplicateTitleException(String message) {
            super(message);
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\GenereDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.GenereDAO;
import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.mo.Genere;

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

public class GenereDAOMySQLJDBCImpl implements GenereDAO {

    private Connection connection;

    public GenereDAOMySQLJDBCImpl(Connection connection) {
        this.connection = connection;
    }

    @Override
    public Genere create(int idGenere, String nomeGenere, List<Film> films) throws DuplicateGenreException {
        PreparedStatement ps;
        Genere genere = new Genere();
        try {
            // Check if the genre name already exists
            if (isGenreNameExist(nomeGenere)) {
                throw new DuplicateGenreException("Il genere '" + nomeGenere + "' esiste gi.");
            }

            String sql = "INSERT INTO genere (nome_genere) VALUES (?)";

            ps = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            ps.setString(1, nomeGenere);

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idGenere = rs.getInt(1);
            }

            genere.setIdGenere(idGenere);
            genere.setNomeGenere(nomeGenere);
            genere.setDeleted(false);

            // Insert film associations
            if (films != null && !films.isEmpty()) {
                insertFilmAssociations(idGenere, films);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return genere;
    }

    @Override
    public void update(Genere genere) throws DuplicateGenreException {
        PreparedStatement ps;
        try {
            // Check if the new genre name already exists (excluding this genre)
            if (isGenreNameExistExcludingThis(genere.getNomeGenere(), genere.getIdGenere())) {
                throw new DuplicateGenreException("Il genere '" + genere.getNomeGenere() + "' esiste gi.");
            }

            String sql = "UPDATE genere SET nome_genere = ?, deleted = ? WHERE id_genere = ?";

            ps = connection.prepareStatement(sql);
            ps.setString(1, genere.getNomeGenere());
            ps.setString(2, genere.isDeleted() ? "y" : "n");
            ps.setInt(3, genere.getIdGenere());

            ps.executeUpdate();

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(Genere genere) {
        PreparedStatement ps;
        try {
            String sql = "UPDATE genere SET deleted = 'y' WHERE id_genere = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, genere.getIdGenere());
            ps.executeUpdate();
            genere.setDeleted(true);

            // Also delete associations in film_genere table
            deleteFilmAssociations(genere.getIdGenere());

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public Genere FindById(Integer idGenere) {
        PreparedStatement ps;
        Genere genere = null;

        try {
            String sql = "SELECT * FROM genere WHERE id_genere = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, idGenere);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                genere = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return genere;
    }

    @Override
    public List<Genere> FindByFilm(List<Film> films) {
        PreparedStatement ps;
        List<Genere> generi = new ArrayList<>();

        try {
            StringBuilder sql = new StringBuilder(
                    "SELECT DISTINCT g.* FROM genere g " +
                            "JOIN film_genere fg ON g.id_genere = fg.genere_id " +
                            "WHERE g.deleted = 'n' AND fg.film_id IN ("
            );
            for (int i = 0; i < films.size(); i++) {
                sql.append(i > 0 ? "," : "").append("?");
            }
            sql.append(")");

            ps = connection.prepareStatement(sql.toString());
            int paramIndex = 1;
            for (Film film : films) {
                ps.setInt(paramIndex++, film.getIdFilm());
            }

            ResultSet resultSet = ps.executeQuery();

            while (resultSet.next()) {
                generi.add(read(resultSet));
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return generi;
    }

    @Override
    public Genere FindByNomeGenere(String nomeGenere) {
        PreparedStatement ps;
        Genere genere = null;

        try {
            String sql = "SELECT * FROM genere WHERE nome_genere = ? AND deleted = 'n'";

            ps = connection.prepareStatement(sql);
            ps.setString(1, nomeGenere);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                genere = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return genere;
    }

    private Genere read(ResultSet rs) throws SQLException {
        Genere genere = new Genere();
        genere.setIdGenere(rs.getInt("id_genere"));
        genere.setNomeGenere(rs.getString("nome_genere"));
        genere.setDeleted(rs.getString("deleted").equals("y"));
        return genere;
    }

    private boolean isGenreNameExist(String nomeGenere) throws SQLException {
        PreparedStatement ps = connection.prepareStatement("SELECT COUNT(*) FROM genere WHERE nome_genere = ? AND deleted = 'n'");
        ps.setString(1, nomeGenere);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    private boolean isGenreNameExistExcludingThis(String nomeGenere, int genreId) throws SQLException {
        PreparedStatement ps = connection.prepareStatement("SELECT COUNT(*) FROM genere WHERE nome_genere = ? AND id_genere != ? AND deleted = 'n'");
        ps.setString(1, nomeGenere);
        ps.setInt(2, genreId);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    private void insertFilmAssociations(int genreId, List<Film> films) throws SQLException {
        String sql = "INSERT INTO film_genere (film_id, genere_id) VALUES (?, ?)";
        PreparedStatement ps = connection.prepareStatement(sql);
        for (Film film : films) {
            ps.setInt(1, film.getIdFilm());
            ps.setInt(2, genreId);
            ps.addBatch();
        }
        ps.executeBatch();
    }

    private void deleteFilmAssociations(int genreId) throws SQLException {
        String sql = "DELETE FROM film_genere WHERE genere_id = ?";
        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setInt(1, genreId);
        ps.executeUpdate();
    }

    public static class DuplicateGenreException extends Exception {
        public DuplicateGenreException(String message) {
            super(message);
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\MySQLJDBCDAOFactory.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.*;
import com.cineplex.cineplex.services.config.Configuration;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.Map;

public class MySQLJDBCDAOFactory extends DAOFactory {

    private Map factoryParameters;

    private Connection connection;

    public MySQLJDBCDAOFactory(Map factoryParameters) {
        this.factoryParameters=factoryParameters;
    }

    @Override
    public void beginTransaction() {

        try {
            Class.forName(Configuration.DATABASE_DRIVER);
            this.connection = DriverManager.getConnection(Configuration.DATABASE_URL);
            this.connection.setAutoCommit(false);
        } catch (ClassNotFoundException e) {
            throw new RuntimeException(e);
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

    }

    @Override
    public void commitTransaction() {
        try {
            this.connection.commit();
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void rollbackTransaction() {

        try {
            this.connection.rollback();
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

    }

    @Override
    public void closeTransaction(){
        try {
            this.connection.close();
        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public AbbonamentoDAO getAbbonamentoDAO() {
        return null;
    }

    @Override
    public BigliettoDAO getBigliettoDAO() {
        return null;
    }

    @Override
    public FilmDAO getFilmDAO() {
        return new FilmDAOMySQLJDBCImpl(connection);
    }

    @Override
    public GenereDAO getGenereDAO() {
        return null;
    }

    @Override
    public ProiezioneDAO getProiezioneDAO() {
        return null;
    }

    @Override
    public RecensioneDAO getRecensioneDAO() {
        return null;
    }

    @Override
    public TipoAbbonamentoDAO getTipoAbbonamentoDAO() {
        return null;
    }

    @Override
    public UtenteDAO getUtenteDAO() {
            return new UtenteDAOMySQLJDBCImpl(connection);
    }

}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\ProiezioneDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.ProiezioneDAO;
import com.cineplex.cineplex.model.mo.Proiezione;

import java.sql.*;
import java.util.Date;
import java.util.ArrayList;
import java.util.List;

public class ProiezioneDAOMySQLJDBCImpl implements ProiezioneDAO {

    private Connection connection;

    public ProiezioneDAOMySQLJDBCImpl(Connection connection) {
        this.connection = connection;
    }

    @Override
    public Proiezione create(Integer idProiezione, Date dataProiezione, Time oraInizio, Integer numeroSala, Integer filmId)
            throws ConflictingProjectionException {
        PreparedStatement ps;
        Proiezione proiezione = new Proiezione();
        try {
            // Check for conflicting projections
            if (isConflictingProjection(dataProiezione, oraInizio, numeroSala, null)) {
                throw new ConflictingProjectionException("Esiste gi una proiezione in conflitto per questa sala e orario.");
            }

            String sql = "INSERT INTO proiezione (data_proiezione, ora_inizio, numero_sala, film_id) VALUES (?,?,?,?)";

            ps = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            ps.setDate(1, new java.sql.Date(dataProiezione.getTime()));
            ps.setTime(2, oraInizio);
            ps.setInt(3, numeroSala);
            ps.setInt(4, filmId);

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idProiezione = rs.getInt(1);
            }

            proiezione.setIdProiezione(idProiezione);
            proiezione.setDataProiezione(dataProiezione);
            proiezione.setOraInizio(oraInizio);
            proiezione.setNumeroSala(numeroSala);
            proiezione.setFilmId(filmId);
            proiezione.setDeleted(false);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return proiezione;
    }

    @Override
    public void update(Proiezione proiezione) throws ConflictingProjectionException {
        PreparedStatement ps;
        try {
            // Check for conflicting projections
            if (isConflictingProjection(proiezione.getDataProiezione(), proiezione.getOraInizio(),
                    proiezione.getNumeroSala(), proiezione.getIdProiezione())) {
                throw new ConflictingProjectionException("Esiste gi una proiezione in conflitto per questa sala e orario.");
            }

            String sql = "UPDATE proiezione SET data_proiezione = ?, ora_inizio = ?, numero_sala = ?, " +
                    "film_id = ?, deleted = ? WHERE id_proiezione = ?";

            ps = connection.prepareStatement(sql);
            ps.setDate(1, new java.sql.Date(proiezione.getDataProiezione().getTime()));
            ps.setTime(2, proiezione.getOraInizio());
            ps.setInt(3, proiezione.getNumeroSala());
            ps.setInt(4, proiezione.getFilmId());
            ps.setString(5, proiezione.isDeleted() ? "y" : "n");
            ps.setInt(6, proiezione.getIdProiezione());

            ps.executeUpdate();

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(Proiezione proiezione) {
        PreparedStatement ps;
        try {
            String sql = "UPDATE proiezione SET deleted = 'y' WHERE id_proiezione = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, proiezione.getIdProiezione());
            ps.executeUpdate();
            proiezione.setDeleted(true);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public Proiezione FindById(Integer idProiezione) {
        PreparedStatement ps;
        Proiezione proiezione = null;

        try {
            String sql = "SELECT * FROM proiezione WHERE id_proiezione = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, idProiezione);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                proiezione = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return proiezione;
    }

    @Override
    public List<Proiezione> FindByFilmId(Integer filmId) {
        PreparedStatement ps;
        List<Proiezione> proiezioni = new ArrayList<>();

        try {
            String sql = "SELECT * FROM proiezione WHERE film_id = ? AND deleted = 'n' ORDER BY data_proiezione, ora_inizio";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, filmId);

            ResultSet resultSet = ps.executeQuery();

            while (resultSet.next()) {
                proiezioni.add(read(resultSet));
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return proiezioni;
    }

    private Proiezione read(ResultSet rs) throws SQLException {
        Proiezione proiezione = new Proiezione();
        proiezione.setIdProiezione(rs.getInt("id_proiezione"));
        proiezione.setDataProiezione(rs.getDate("data_proiezione"));
        proiezione.setOraInizio(rs.getTime("ora_inizio"));
        proiezione.setNumeroSala(rs.getInt("numero_sala"));
        proiezione.setFilmId(rs.getInt("film_id"));
        proiezione.setDeleted(rs.getString("deleted").equals("y"));
        return proiezione;
    }

    private boolean isConflictingProjection(Date dataProiezione, Time oraInizio, Integer numeroSala, Integer excludeId) throws SQLException {
        String sql = "SELECT COUNT(*) FROM proiezione p JOIN film f ON p.film_id = f.id_film " +
                "WHERE p.numero_sala = ? AND p.data_proiezione = ? AND p.deleted = 'n' " +
                "AND ((p.ora_inizio <= ? AND ADDTIME(p.ora_inizio, SEC_TO_TIME(f.durata_minuti * 60)) > ?) " +
                "OR (p.ora_inizio < ADDTIME(?, SEC_TO_TIME(? * 60)) AND p.ora_inizio >= ?))";

        if (excludeId != null) {
            sql += " AND p.id_proiezione != ?";
        }

        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setInt(1, numeroSala);
        ps.setDate(2, new java.sql.Date(dataProiezione.getTime()));
        ps.setTime(3, oraInizio);
        ps.setTime(4, oraInizio);
        ps.setTime(5, oraInizio);
        ps.setInt(6, 120); // Assuming a standard 2-hour duration, adjust as needed
        ps.setTime(7, oraInizio);

        if (excludeId != null) {
            ps.setInt(8, excludeId);
        }

        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    public static class ConflictingProjectionException extends Exception {
        public ConflictingProjectionException(String message) {
            super(message);
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\RecensioneDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.RecensioneDAO;
import com.cineplex.cineplex.model.mo.Recensione;
import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.mo.Utente;

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

public class RecensioneDAOMySQLJDBCImpl implements RecensioneDAO {

    private Connection connection;

    public RecensioneDAOMySQLJDBCImpl(Connection connection) {
        this.connection = connection;
    }

    @Override
    public Recensione create(Integer idRecensione, Integer valutazione, String titoloRecensione, String testo,
                             Utente utente, Film film) throws DuplicateReviewException {
        PreparedStatement ps;
        Recensione recensione = new Recensione();
        try {
            // Check if the user has already reviewed this film
            if (hasUserReviewedFilm(utente.getIdUtente(), film.getIdFilm())) {
                throw new DuplicateReviewException("L'utente ha gi recensito questo film.");
            }

            String sql = "INSERT INTO recensione (valutazione, titolo_recensione, testo, data_scrittura, utente_id, film_id) " +
                    "VALUES (?,?,?,NOW(),?,?)";

            ps = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            int i = 1;
            ps.setInt(i++, valutazione);
            ps.setString(i++, titoloRecensione);
            ps.setString(i++, testo);
            ps.setInt(i++, utente.getIdUtente());
            ps.setInt(i++, film.getIdFilm());

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idRecensione = rs.getInt(1);
            }

            // Fetch the newly created review to get the server-generated timestamp
            recensione = FindById(idRecensione);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return recensione;
    }

    @Override
    public void update(Recensione recensione) {
        PreparedStatement ps;
        try {
            String sql = "UPDATE recensione SET valutazione = ?, titolo_recensione = ?, testo = ?, " +
                    "data_scrittura = NOW(), deleted = ? WHERE id_recensione = ?";

            ps = connection.prepareStatement(sql);
            int i = 1;
            ps.setInt(i++, recensione.getValutazione());
            ps.setString(i++, recensione.getTitoloRecensione());
            ps.setString(i++, recensione.getTesto());
            ps.setString(i++, recensione.isDeleted() ? "y" : "n");
            ps.setInt(i++, recensione.getIdRecensione());

            ps.executeUpdate();

            // Update the recensione object with the new data_scrittura
            Recensione updatedRecensione = FindById(recensione.getIdRecensione());
            recensione.setDataScrittura(updatedRecensione.getDataScrittura());

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(Recensione recensione) {
        PreparedStatement ps;
        try {
            String sql = "UPDATE recensione SET deleted = 'y' WHERE id_recensione = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, recensione.getIdRecensione());
            ps.executeUpdate();
            recensione.setDeleted(true);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public Recensione FindById(Integer idRecensione) {
        PreparedStatement ps;
        Recensione recensione = null;

        try {
            String sql = "SELECT * FROM recensione WHERE id_recensione = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, idRecensione);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                recensione = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return recensione;
    }

    @Override
    public List<Recensione> FindByUserId(Utente utente) {
        PreparedStatement ps;
        List<Recensione> recensioni = new ArrayList<>();

        try {
            String sql = "SELECT * FROM recensione WHERE utente_id = ? AND deleted = 'n' ORDER BY data_scrittura DESC";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, utente.getIdUtente());

            ResultSet resultSet = ps.executeQuery();

            while (resultSet.next()) {
                recensioni.add(read(resultSet));
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return recensioni;
    }

    @Override
    public List<Recensione> FindByFilm(Film film) {
        PreparedStatement ps;
        List<Recensione> recensioni = new ArrayList<>();

        try {
            String sql = "SELECT * FROM recensione WHERE film_id = ? AND deleted = 'n' ORDER BY data_scrittura DESC";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, film.getIdFilm());

            ResultSet resultSet = ps.executeQuery();

            while (resultSet.next()) {
                recensioni.add(read(resultSet));
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return recensioni;
    }

    private Recensione read(ResultSet rs) throws SQLException {
        Recensione recensione = new Recensione();
        recensione.setIdRecensione(rs.getInt("id_recensione"));
        recensione.setValutazione(rs.getInt("valutazione"));
        recensione.setTitoloRecensione(rs.getString("titolo_recensione"));
        recensione.setTesto(rs.getString("testo"));
        recensione.setDataScrittura(rs.getTimestamp("data_scrittura"));

        Utente utente = new Utente();
        utente.setIdUtente(rs.getInt("utente_id"));
        recensione.setUtente(utente);

        Film film = new Film();
        film.setIdFilm(rs.getInt("film_id"));
        recensione.setFilm(film);

        recensione.setDeleted(rs.getString("deleted").equals("y"));
        return recensione;
    }

    private boolean hasUserReviewedFilm(int userId, int filmId) throws SQLException {
        String sql = "SELECT COUNT(*) FROM recensione WHERE utente_id = ? AND film_id = ? AND deleted = 'n'";
        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setInt(1, userId);
        ps.setInt(2, filmId);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    public static class DuplicateReviewException extends Exception {
        public DuplicateReviewException(String message) {
            super(message);
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\TipoAbbonamentoDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.TipoAbbonamentoDAO;
import com.cineplex.cineplex.model.mo.TipoAbbonamento;

import java.sql.*;
import java.math.BigDecimal;
import java.util.ArrayList;
import java.util.List;

public class TipoAbbonamentoDAOMySQLJDBCImpl implements TipoAbbonamentoDAO {

    private Connection connection;

    public TipoAbbonamentoDAOMySQLJDBCImpl(Connection connection) {
        this.connection = connection;
    }

    @Override
    public TipoAbbonamento create(Integer idTipoAbbonamento, String tipo, BigDecimal costo, Integer durataGiorni, Integer numeroIngressi)
            throws DuplicateTypeException {
        PreparedStatement ps;
        TipoAbbonamento tipoAbbonamento = new TipoAbbonamento();
        try {
            // Check if the tipo already exists
            if (isTipoExist(tipo)) {
                throw new DuplicateTypeException("Il tipo di abbonamento '" + tipo + "' esiste gi.");
            }

            String sql = "INSERT INTO tipo_abbonamento (tipo, costo, durata_giorni, numero_ingressi) VALUES (?,?,?,?)";

            ps = connection.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            int i = 1;
            ps.setString(i++, tipo);
            ps.setBigDecimal(i++, costo);
            ps.setInt(i++, durataGiorni);
            ps.setInt(i++, numeroIngressi);

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idTipoAbbonamento = rs.getInt(1);
            }

            tipoAbbonamento.setIdTipoAbbonamento(idTipoAbbonamento);
            tipoAbbonamento.setTipo(tipo);
            tipoAbbonamento.setCosto(costo);
            tipoAbbonamento.setDurataGiorni(durataGiorni);
            tipoAbbonamento.setNumeroIngressi(numeroIngressi);
            tipoAbbonamento.setDeleted(false);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return tipoAbbonamento;
    }

    @Override
    public void update(TipoAbbonamento tipoAbbonamento) throws DuplicateTypeException {
        PreparedStatement ps;
        try {
            // Check if the new tipo already exists (excluding this record)
            if (isTipoExistExcludingThis(tipoAbbonamento.getTipo(), tipoAbbonamento.getIdTipoAbbonamento())) {
                throw new DuplicateTypeException("Il tipo di abbonamento '" + tipoAbbonamento.getTipo() + "' esiste gi.");
            }

            String sql = "UPDATE tipo_abbonamento SET tipo = ?, costo = ?, durata_giorni = ?, " +
                    "numero_ingressi = ?, deleted = ? WHERE id_tipo_abbonamento = ?";

            ps = connection.prepareStatement(sql);
            int i = 1;
            ps.setString(i++, tipoAbbonamento.getTipo());
            ps.setBigDecimal(i++, tipoAbbonamento.getCosto());
            ps.setInt(i++, tipoAbbonamento.getDurataGiorni());
            ps.setInt(i++, tipoAbbonamento.getNumeroIngressi());
            ps.setString(i++, tipoAbbonamento.isDeleted() ? "y" : "n");
            ps.setInt(i++, tipoAbbonamento.getIdTipoAbbonamento());

            ps.executeUpdate();

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(TipoAbbonamento tipoAbbonamento) {
        PreparedStatement ps;
        try {
            String sql = "UPDATE tipo_abbonamento SET deleted = 'y' WHERE id_tipo_abbonamento = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, tipoAbbonamento.getIdTipoAbbonamento());
            ps.executeUpdate();
            tipoAbbonamento.setDeleted(true);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    public List<TipoAbbonamento> findAll() {
        PreparedStatement ps;
        List<TipoAbbonamento> tipiAbbonamento = new ArrayList<>();

        try {
            String sql = "SELECT * FROM tipo_abbonamento WHERE deleted = 'n'";

            ps = connection.prepareStatement(sql);
            ResultSet resultSet = ps.executeQuery();

            while (resultSet.next()) {
                tipiAbbonamento.add(read(resultSet));
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return tipiAbbonamento;
    }

    public TipoAbbonamento findById(Integer idTipoAbbonamento) {
        PreparedStatement ps;
        TipoAbbonamento tipoAbbonamento = null;

        try {
            String sql = "SELECT * FROM tipo_abbonamento WHERE id_tipo_abbonamento = ?";

            ps = connection.prepareStatement(sql);
            ps.setInt(1, idTipoAbbonamento);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                tipoAbbonamento = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return tipoAbbonamento;
    }

    private TipoAbbonamento read(ResultSet rs) throws SQLException {
        TipoAbbonamento tipoAbbonamento = new TipoAbbonamento();
        tipoAbbonamento.setIdTipoAbbonamento(rs.getInt("id_tipo_abbonamento"));
        tipoAbbonamento.setTipo(rs.getString("tipo"));
        tipoAbbonamento.setCosto(rs.getBigDecimal("costo"));
        tipoAbbonamento.setDurataGiorni(rs.getInt("durata_giorni"));
        tipoAbbonamento.setNumeroIngressi(rs.getInt("numero_ingressi"));
        tipoAbbonamento.setDeleted(rs.getString("deleted").equals("y"));
        return tipoAbbonamento;
    }

    private boolean isTipoExist(String tipo) throws SQLException {
        String sql = "SELECT COUNT(*) FROM tipo_abbonamento WHERE tipo = ? AND deleted = 'n'";
        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setString(1, tipo);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    private boolean isTipoExistExcludingThis(String tipo, int idTipoAbbonamento) throws SQLException {
        String sql = "SELECT COUNT(*) FROM tipo_abbonamento WHERE tipo = ? AND id_tipo_abbonamento != ? AND deleted = 'n'";
        PreparedStatement ps = connection.prepareStatement(sql);
        ps.setString(1, tipo);
        ps.setInt(2, idTipoAbbonamento);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    public static class DuplicateTypeException extends Exception {
        public DuplicateTypeException(String message) {
            super(message);
        }
    }
}
```

# src\main\java\com\cineplex\cineplex\model\dao\mySQLJDBCImpl\UtenteDAOMySQLJDBCImpl.java

```java
package com.cineplex.cineplex.model.dao.mySQLJDBCImpl;

import com.cineplex.cineplex.model.dao.UtenteDAO;
import com.cineplex.cineplex.model.mo.Utente;
import com.cineplex.cineplex.model.dao.exceptions.UserExceptions.DuplicateEmailException;
import com.cineplex.cineplex.model.dao.exceptions.UserExceptions.DuplicateUsernameException;

import java.sql.*;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;

public class UtenteDAOMySQLJDBCImpl implements UtenteDAO {

    Connection conn;

    public UtenteDAOMySQLJDBCImpl(Connection conn) {
        this.conn = conn;
    }

    @Override
    public Utente create(Integer idUtente, String nome, String cognome, String username, String email, String password, Boolean newsletter, String tipo)
            throws DuplicateUsernameException, DuplicateEmailException {

        PreparedStatement ps;
        Utente utente = new Utente();
        try {
            // Check if username already exists
            if (usernameExists(username)) {
                throw new DuplicateUsernameException("Username already exists");
            }

            // Check if email already exists
            if (emailExists(email)) {
                throw new DuplicateEmailException("Email already exists");
            }

            String sql = "INSERT INTO utente (nome, cognome, username, email, password, newsletter, tipo) VALUES (?,?,?,?,?,?,?)";

            ps = conn.prepareStatement(sql, Statement.RETURN_GENERATED_KEYS);
            int i = 1;
            ps.setString(i++, nome);
            ps.setString(i++, cognome);
            ps.setString(i++, username);
            ps.setString(i++, email);
            ps.setString(i++, hashPassword(password));
            ps.setString(i++, newsletter ? "y" : "n");
            ps.setString(i++, tipo);

            ps.executeUpdate();

            ResultSet rs = ps.getGeneratedKeys();
            if (rs.next()) {
                idUtente = rs.getInt(1);
            }

            utente.setIdUtente(idUtente);
            utente.setNome(nome);
            utente.setCognome(cognome);
            utente.setUsername(username);
            utente.setEmail(email);
            utente.setPassword(password); // Note: We're not storing the hashed password in the object
            utente.setNewsletter(newsletter);
            utente.setTipo(tipo);
            utente.setDeleted(false);
            utente.setBanned(false);

        } catch (SQLException | NoSuchAlgorithmException e) {
            throw new RuntimeException(e);
        }

        return utente;
    }

    @Override
    public Utente authenticate(String username, String password) {
        PreparedStatement ps;
        Utente utente = null;

        try {
            String sql = "SELECT * FROM utente WHERE username = ? AND deleted = 'n'";
            ps = conn.prepareStatement(sql);
            ps.setString(1, username);

            ResultSet rs = ps.executeQuery();

            if (rs.next()) {
                String storedHash = rs.getString("password");
                if (verifyPassword(password, storedHash)) {
                    utente = read(rs);
                }
            }
        } catch (SQLException | NoSuchAlgorithmException e) {
            throw new RuntimeException(e);
        }

        return utente;
    }

    private boolean usernameExists(String username) throws SQLException {
        PreparedStatement ps = conn.prepareStatement("SELECT COUNT(*) FROM utente WHERE username = ?");
        ps.setString(1, username);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    private boolean emailExists(String email) throws SQLException {
        PreparedStatement ps = conn.prepareStatement("SELECT COUNT(*) FROM utente WHERE email = ?");
        ps.setString(1, email);
        ResultSet rs = ps.executeQuery();
        rs.next();
        return rs.getInt(1) > 0;
    }

    private String hashPassword(String password) throws NoSuchAlgorithmException {
        MessageDigest md = MessageDigest.getInstance("SHA-256");
        byte[] hashedBytes = md.digest(password.getBytes());
        StringBuilder sb = new StringBuilder();
        for (byte b : hashedBytes) {
            sb.append(String.format("%02x", b));
        }
        return sb.toString();
    }

    private boolean verifyPassword(String inputPassword, String storedHash) throws NoSuchAlgorithmException {
        String inputHash = hashPassword(inputPassword);
        return inputHash.equals(storedHash);
    }

    @Override
    public void update(Utente utente) throws DuplicateUsernameException, DuplicateEmailException {
        PreparedStatement ps;
        try {
            // Check if username already exists (excluding the current user)
            ps = conn.prepareStatement("SELECT COUNT(*) FROM utente WHERE username = ? AND id_utente != ?");
            ps.setString(1, utente.getUsername());
            ps.setInt(2, utente.getIdUtente());
            ResultSet rs = ps.executeQuery();
            rs.next();
            if (rs.getInt(1) > 0) {
                throw new DuplicateUsernameException("Username already exists");
            }

            // Check if email already exists (excluding the current user)
            ps = conn.prepareStatement("SELECT COUNT(*) FROM utente WHERE email = ? AND id_utente != ?");
            ps.setString(1, utente.getEmail());
            ps.setInt(2, utente.getIdUtente());
            rs = ps.executeQuery();
            rs.next();
            if (rs.getInt(1) > 0) {
                throw new DuplicateEmailException("Email already exists");
            }

            String sql
                    = " UPDATE utente"
                    + " SET nome = ?,"
                    + " cognome = ?,"
                    + " username = ?,"
                    + " email = ?,"
                    + " password = ?,"
                    + " newsletter = ?,"
                    + " tipo = ?,"
                    + " banned = ?,"
                    + " deleted = ?"
                    + " WHERE"
                    + " id_utente = ?";

            ps = conn.prepareStatement(sql);
            int i = 1;
            ps.setString(i++, utente.getNome());
            ps.setString(i++, utente.getCognome());
            ps.setString(i++, utente.getUsername());
            ps.setString(i++, utente.getEmail());
            ps.setString(i++, utente.getPassword());
            ps.setString(i++, utente.isNewsletter() ? "y" : "n");
            ps.setString(i++, utente.getTipo());
            ps.setString(i++, utente.isBanned() ? "y" : "n");
            ps.setString(i++, utente.isDeleted() ? "y" : "n");
            ps.setInt(i++, utente.getIdUtente());

            ps.executeUpdate();

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void delete(Utente utente) {
        PreparedStatement ps;
        try {
            String sql
                    = " UPDATE utente"
                    + " SET deleted = 'y'"
                    + " WHERE"
                    + " id_utente = ?";

            ps = conn.prepareStatement(sql);
            ps.setInt(1, utente.getIdUtente());
            ps.executeUpdate();
            utente.setDeleted(true);

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void banUtente(int idUtente) {
        PreparedStatement ps;
        try {
            String sql
                    = " UPDATE utente"
                    + " SET banned = 'y'"
                    + " WHERE"
                    + " id_utente = ?";

            ps = conn.prepareStatement(sql);
            ps.setInt(1, idUtente);

            int rowsAffected = ps.executeUpdate();
            if (rowsAffected == 0) {
                throw new SQLException("Banning user failed, no rows affected.");
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public void unbanUtente(int idUtente) {
        PreparedStatement ps;
        try {
            String sql
                    = " UPDATE utente"
                    + " SET banned = 'n'"
                    + " WHERE"
                    + " id_utente = ?";

            ps = conn.prepareStatement(sql);
            ps.setInt(1, idUtente);

            int rowsAffected = ps.executeUpdate();
            if (rowsAffected == 0) {
                throw new SQLException("Unbanning user failed, no rows affected.");
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }
    }

    @Override
    public Utente findLoggedUser() {
        throw new UnsupportedOperationException("Not supported");

    }

    @Override
    public Utente FindById(Integer idUtente) {
        PreparedStatement ps;
        Utente utente = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM utente"
                    + " WHERE"
                    + " id_utente = ?";

            ps = conn.prepareStatement(sql);
            ps.setInt(1, idUtente);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                utente = read(resultSet);
            }

        }catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return utente;
    }

    private Utente read(ResultSet rs) throws SQLException {
        Utente utente = new Utente();
        utente.setIdUtente(rs.getInt("id_utente"));
        utente.setNome(rs.getString("nome"));
        utente.setCognome(rs.getString("cognome"));
        utente.setUsername(rs.getString("username"));
        utente.setEmail(rs.getString("email"));
        // Note: We're not setting the password in the object for security reasons
        utente.setNewsletter(rs.getString("newsletter").equals("y"));
        utente.setTipo(rs.getString("tipo"));
        utente.setBanned(rs.getString("banned").equals("y"));
        utente.setDeleted(rs.getString("deleted").equals("y"));
        return utente;
    }

    @Override
    public Utente FindByUsername(String username) {
        PreparedStatement ps;
        Utente utente = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM utente"
                    + " WHERE"
                    + " username = ?";

            ps = conn.prepareStatement(sql);
            ps.setString(1, username);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                utente = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return utente;
    }

    @Override
    public Utente FindByEmail(String email) {
        PreparedStatement ps;
        Utente utente = null;

        try {
            String sql
                    = " SELECT *"
                    + " FROM utente"
                    + " WHERE"
                    + " email = ?";

            ps = conn.prepareStatement(sql);
            ps.setString(1, email);

            ResultSet resultSet = ps.executeQuery();

            if (resultSet.next()) {
                utente = read(resultSet);
            }

        } catch (SQLException e) {
            throw new RuntimeException(e);
        }

        return utente;
    }


}

```

# src\main\java\com\cineplex\cineplex\model\dao\ProiezioneDAO.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.mo.Proiezione;
import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.ProiezioneDAOMySQLJDBCImpl.ConflictingProjectionException;

import java.sql.Time;
import java.util.Date;
import java.util.List;

public interface ProiezioneDAO {
    Proiezione create(Integer idProiezione, Date dataProiezione, Time oraInizio, Integer numeroSala, Integer filmId)
            throws ConflictingProjectionException;

    void update(Proiezione proiezione) throws ConflictingProjectionException;

    void delete(Proiezione proiezione);

    Proiezione FindById(Integer idProiezione);

    List<Proiezione> FindByFilmId(Integer filmId);
}
```

# src\main\java\com\cineplex\cineplex\model\dao\RecensioneDAO.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.RecensioneDAOMySQLJDBCImpl;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.Film;
import com.cineplex.cineplex.model.mo.Recensione;
import com.cineplex.cineplex.model.mo.Utente;

import java.util.Date;
import java.util.List;

public interface RecensioneDAO {
    Recensione create(Integer idRecensione, Integer valutazione, String titoloRecensione, String testo,
                      Utente utente, Film film) throws RecensioneDAOMySQLJDBCImpl.DuplicateReviewException;

    void update(Recensione recensione);


    public void delete(Recensione recensione);

    public Recensione FindById(Integer idRecensione);

    public List<Recensione> FindByUserId(Utente utente);

    public List<Recensione> FindByFilm(Film film);
}

```

# src\main\java\com\cineplex\cineplex\model\dao\TipoAbbonamentoDAO.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.TipoAbbonamentoDAOMySQLJDBCImpl;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.TipoAbbonamento;

import java.math.BigDecimal;
import java.util.List;

public interface TipoAbbonamentoDAO {
    public TipoAbbonamento create(Integer idTipoAbbonamento, String tipo, BigDecimal costo, Integer durataGiorni, Integer numeroIngressi)
            throws TipoAbbonamentoDAOMySQLJDBCImpl.DuplicateTypeException;

    public void update(TipoAbbonamento tipoAbbonamento) throws TipoAbbonamentoDAOMySQLJDBCImpl.DuplicateTypeException;

    public void delete(TipoAbbonamento tipoAbbonamento);

    public List<TipoAbbonamento> findAll();

    public TipoAbbonamento findById(Integer idTipoAbbonamento);
}

```

# src\main\java\com\cineplex\cineplex\model\dao\UtenteDAO.java

```java
package com.cineplex.cineplex.model.dao;

import com.cineplex.cineplex.model.dao.exceptions.UserExceptions.DuplicateUsernameException;
import com.cineplex.cineplex.model.dao.exceptions.UserExceptions.DuplicateEmailException;

import com.cineplex.cineplex.model.dao.mySQLJDBCImpl.UtenteDAOMySQLJDBCImpl;
import com.cineplex.cineplex.model.mo.Abbonamento;
import com.cineplex.cineplex.model.mo.Utente;

public interface UtenteDAO {
        public Utente create(
                Integer idUtente,
                String nome,
                String cognome,
                String username,
                String email,
                String password,
                Boolean newsletter,
                String tipo
        ) throws DuplicateUsernameException, DuplicateEmailException;


    Utente authenticate(String username, String password);

    public void update(Utente utente)throws DuplicateUsernameException, DuplicateEmailException;

    public void delete(Utente utente);


    public void banUtente(int idUtente);

    public void unbanUtente(int idUtente);


    public Utente findLoggedUser();

    public Utente FindById(Integer idUtente);

    public Utente FindByUsername(String username);

    public Utente FindByEmail(String email);


}

```

# src\main\java\com\cineplex\cineplex\model\mo\Abbonamento.java

```java
package com.cineplex.cineplex.model.mo;

import java.util.Date;

public class Abbonamento {
    private Integer idAbbonamento;
    private Date dataSottoscrizione;
    private Utente utenteId;
    private TipoAbbonamento tipoAbbonamentoId;
    private Boolean deleted;

    // costruttori
    public Abbonamento() {}

    public Abbonamento(Integer idAbbonamento, Date dataSottoscrizione, Utente utenteId, TipoAbbonamento tipoAbbonamentoId, Boolean deleted) {
        this.idAbbonamento = idAbbonamento;
        this.dataSottoscrizione = dataSottoscrizione;
        this.utenteId = utenteId;
        this.tipoAbbonamentoId = tipoAbbonamentoId;
        this.deleted = deleted;
    }

    // get  & set
    public Integer getIdAbbonamento() {
        return idAbbonamento;
    }

    public void setIdAbbonamento(Integer idAbbonamento) {
        this.idAbbonamento = idAbbonamento;
    }

    public Date getDataSottoscrizione() {
        return dataSottoscrizione;
    }

    public void setDataSottoscrizione(Date dataSottoscrizione) {
        this.dataSottoscrizione = dataSottoscrizione;
    }

    public Utente getUtenteId() {
        return utenteId;
    }

    public void setUtenteId(Utente utenteId) {
        this.utenteId = utenteId;
    }

    public TipoAbbonamento getTipoAbbonamentoId() {
        return tipoAbbonamentoId;
    }

    public void setTipoAbbonamentoId(TipoAbbonamento tipoAbbonamentoId) {
        this.tipoAbbonamentoId = tipoAbbonamentoId;
    }

    public boolean isDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\mo\Biglietto.java

```java
package com.cineplex.cineplex.model.mo;

public class Biglietto {
    private Integer idBiglietto;
    private String posto;
    private Boolean ingressoAbbonamento;
    private Utente utente;
    private Proiezione proiezione;
    private Boolean deleted;

    // Constructors
    public Biglietto() {}

    public Biglietto(Integer idBiglietto, String posto, Boolean ingressoAbbonamento, Utente utente, Proiezione proiezione, Boolean deleted) {
        this.idBiglietto = idBiglietto;
        this.posto = posto;
        this.ingressoAbbonamento = ingressoAbbonamento;
        this.utente = utente;
        this.proiezione = proiezione;
        this.deleted = deleted;
    }

    // Getters and Setters
    public Integer getIdBiglietto() {
        return idBiglietto;
    }

    public void setIdBiglietto(Integer idBiglietto) {
        this.idBiglietto = idBiglietto;
    }

    public String getPosto() {
        return posto;
    }

    public void setPosto(String posto) {
        this.posto = posto;
    }

    public Boolean isIngressoAbbonamento() {
        return ingressoAbbonamento;
    }

    public void setIngressoAbbonamento(Boolean ingressoAbbonamento) {
        this.ingressoAbbonamento = ingressoAbbonamento;
    }

    public Utente getUtente() {
        return utente;
    }

    public void setUtente(Utente utente) {
        this.utente = utente;
    }

    public Proiezione getProiezione() {
        return proiezione;
    }

    public void setProiezione(Proiezione proiezione) {
        this.proiezione = proiezione;
    }

    public Boolean isDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\mo\Film.java

```java
package com.cineplex.cineplex.model.mo;


import java.util.Date;
import java.util.List;
import java.util.ArrayList;

public class Film {
    private Integer idFilm;
    private String titolo;
    private Date dataInizioDisponibilita;
    private Date dataFineDisponibilita;
    private String percorsoLocandina;
    private Date dataPubblicazione;
    private Integer durataMinuti;
    private String descrizione;
    private String linkTrailerYt;
    private String regista;
    private Boolean deleted;
    private List<Genere> generi;

    // Constructors
    public Film() {
        this.generi = new ArrayList<>();
    }

    public Film(Integer idFilm, String titolo, Date dataInizioDisponibilita, Date dataFineDisponibilita,
                String percorsoLocandina, Date dataPubblicazione, Integer durataMinuti, String descrizione,
                String linkTrailerYt, String regista, Boolean deleted) {
        this.idFilm = idFilm;
        this.titolo = titolo;
        this.dataInizioDisponibilita = dataInizioDisponibilita;
        this.dataFineDisponibilita = dataFineDisponibilita;
        this.percorsoLocandina = percorsoLocandina;
        this.dataPubblicazione = dataPubblicazione;
        this.durataMinuti = durataMinuti;
        this.descrizione = descrizione;
        this.linkTrailerYt = linkTrailerYt;
        this.regista = regista;
        this.deleted = deleted;
        this.generi = new ArrayList<>();
    }


    public List<Genere> getGeneri() {
        return generi;
    }

    public void setGeneri(List<Genere> generi) {
        this.generi = generi;
    }

    public Integer getIdFilm() {
        return idFilm;
    }

    public void setIdFilm(Integer idFilm) {
        this.idFilm = idFilm;
    }

    public String getTitolo() {
        return titolo;
    }

    public void setTitolo(String titolo) {
        this.titolo = titolo;
    }

    public Date getDataInizioDisponibilita() {
        return dataInizioDisponibilita;
    }

    public void setDataInizioDisponibilita(Date dataInizioDisponibilita) {
        this.dataInizioDisponibilita = dataInizioDisponibilita;
    }

    public Date getDataFineDisponibilita() {
        return dataFineDisponibilita;
    }

    public void setDataFineDisponibilita(Date dataFineDisponibilita) {
        this.dataFineDisponibilita = dataFineDisponibilita;
    }

    public String getPercorsoLocandina() {
        return percorsoLocandina;
    }

    public void setPercorsoLocandina(String percorsoLocandina) {
        this.percorsoLocandina = percorsoLocandina;
    }

    public Date getDataPubblicazione() {
        return dataPubblicazione;
    }

    public void setDataPubblicazione(Date dataPubblicazione) {
        this.dataPubblicazione = dataPubblicazione;
    }

    public Integer getDurataMinuti() {
        return durataMinuti;
    }

    public void setDurataMinuti(Integer durataMinuti) {
        this.durataMinuti = durataMinuti;
    }

    public String getDescrizione() {
        return descrizione;
    }

    public void setDescrizione(String descrizione) {
        this.descrizione = descrizione;
    }

    public String getLinkTrailerYt() {
        return linkTrailerYt;
    }

    public void setLinkTrailerYt(String linkTrailerYt) {
        this.linkTrailerYt = linkTrailerYt;
    }

    public String getRegista() {
        return regista;
    }

    public void setRegista(String regista) {
        this.regista = regista;
    }

    public Boolean getDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\mo\Genere.java

```java
package com.cineplex.cineplex.model.mo;

import java.util.List;
import java.util.ArrayList;

public class Genere {
    private Integer idGenere;
    private String nomeGenere;
    private Boolean deleted;

    // Constructors
    public Genere() {}

    public Genere(Integer idGenere, String nomeGenere, Boolean deleted) {
        this.idGenere = idGenere;
        this.nomeGenere = nomeGenere;
        this.deleted = deleted;
    }

    public Integer getIdGenere() {
        return idGenere;
    }

    public void setIdGenere(Integer idGenere) {
        this.idGenere = idGenere;
    }

    public String getNomeGenere() {
        return nomeGenere;
    }

    public void setNomeGenere(String nomeGenere) {
        this.nomeGenere = nomeGenere;
    }

    public Boolean isDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\mo\Proiezione.java

```java
package com.cineplex.cineplex.model.mo;


import java.util.Date;
import java.sql.Time;

public class Proiezione {
    private Integer idProiezione;
    private Date dataProiezione;
    private Time oraInizio;
    private Integer numeroSala;
    private Integer filmId;
    private Boolean deleted;

    // costruttori
    public Proiezione() {}

    public Proiezione(Integer idProiezione, Date dataProiezione, Time oraInizio, Integer numeroSala, Integer filmId, Boolean deleted) {
        this.idProiezione = idProiezione;
        this.dataProiezione = dataProiezione;
        this.oraInizio = oraInizio;
        this.numeroSala = numeroSala;
        this.filmId = filmId;
        this.deleted = deleted;
    }

    // get & set
    public Integer getIdProiezione() {
        return idProiezione;
    }

    public void setIdProiezione(Integer idProiezione) {
        this.idProiezione = idProiezione;
    }

    public Date getDataProiezione() {
        return dataProiezione;
    }

    public void setDataProiezione(Date dataProiezione) {
        this.dataProiezione = dataProiezione;
    }

    public Time getOraInizio() {
        return oraInizio;
    }

    public void setOraInizio(Time oraInizio) {
        this.oraInizio = oraInizio;
    }

    public Integer getNumeroSala() {
        return numeroSala;
    }

    public void setNumeroSala(Integer numeroSala) {
        this.numeroSala = numeroSala;
    }

    public Integer getFilmId() {
        return filmId;
    }

    public void setFilmId(Integer filmId) {
        this.filmId = filmId;
    }

    public Boolean isDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\mo\Recensione.java

```java
package com.cineplex.cineplex.model.mo;


import java.util.Date;

public class Recensione {
    private Integer idRecensione;
    private Integer valutazione;
    private String titoloRecensione;
    private String testo;
    private Date dataScrittura;
    private Utente utente;
    private Film film;
    private Boolean deleted;

    // Constructors
    public Recensione() {}

    public Recensione(Integer idRecensione, Integer valutazione, String titoloRecensione, String testo,
                      Date dataScrittura, Utente utente, Film film, Boolean deleted) {
        this.idRecensione = idRecensione;
        this.valutazione = valutazione;
        this.titoloRecensione = titoloRecensione;
        this.testo = testo;
        this.dataScrittura = dataScrittura;
        this.utente = utente;
        this.film = film;
        this.deleted = deleted;
    }

    // Getters and Setters
    public Integer getIdRecensione() {
        return idRecensione;
    }

    public void setIdRecensione(Integer idRecensione) {
        this.idRecensione = idRecensione;
    }

    public Integer getValutazione() {
        return valutazione;
    }

    public void setValutazione(Integer valutazione) {
        this.valutazione = valutazione;
    }

    public String getTitoloRecensione() {
        return titoloRecensione;
    }

    public void setTitoloRecensione(String titoloRecensione) {
        this.titoloRecensione = titoloRecensione;
    }

    public String getTesto() {
        return testo;
    }

    public void setTesto(String testo) {
        this.testo = testo;
    }

    public Date getDataScrittura() {
        return dataScrittura;
    }

    public void setDataScrittura(Date dataScrittura) {
        this.dataScrittura = dataScrittura;
    }

    public Utente getUtente() {
        return utente;
    }

    public void setUtente(Utente utente) {
        this.utente = utente;
    }

    public Film getFilm() {
        return film;
    }

    public void setFilm(Film film) {
        this.film = film;
    }

    public Boolean isDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\mo\TipoAbbonamento.java

```java
package com.cineplex.cineplex.model.mo;

import java.math.BigDecimal;

public class TipoAbbonamento {
    private Integer idTipoAbbonamento;
    private String tipo;
    private BigDecimal costo;
    private Integer durataGiorni;
    private Integer numeroIngressi;
    private Boolean deleted;

    // costruttori
    public TipoAbbonamento() {}

    public TipoAbbonamento(Integer idTipoAbbonamento, String tipo, BigDecimal costo, Integer durataGiorni, Integer numeroIngressi, Boolean deleted) {
        this.idTipoAbbonamento = idTipoAbbonamento;
        this.tipo = tipo;
        this.costo = costo;
        this.durataGiorni = durataGiorni;
        this.numeroIngressi = numeroIngressi;
        this.deleted = deleted;
    }

    // get & set
    public Integer getIdTipoAbbonamento() {
        return idTipoAbbonamento;
    }

    public void setIdTipoAbbonamento(Integer idTipoAbbonamento) {
        this.idTipoAbbonamento = idTipoAbbonamento;
    }

    public String getTipo() {
        return tipo;
    }

    public void setTipo(String tipo) {
        this.tipo = tipo;
    }

    public BigDecimal getCosto() {
        return costo;
    }

    public void setCosto(BigDecimal costo) {
        this.costo = costo;
    }

    public Integer getDurataGiorni() {
        return durataGiorni;
    }

    public void setDurataGiorni(Integer durataGiorni) {
        this.durataGiorni = durataGiorni;
    }

    public Integer getNumeroIngressi() {
        return numeroIngressi;
    }

    public void setNumeroIngressi(Integer numeroIngressi) {
        this.numeroIngressi = numeroIngressi;
    }

    public Boolean isDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }
}
```

# src\main\java\com\cineplex\cineplex\model\mo\Utente.java

```java
package com.cineplex.cineplex.model.mo;


public class Utente {
    private Integer idUtente;
    private String nome;
    private String cognome;

    private String username;

    private String email;
    private String password;
    private Boolean newsletter;
    private String tipo;
    private Boolean banned;
    private Boolean deleted;


    public Utente() {}

    //costruttore
    public Utente(Integer idUtente, String nome, String cognome, String username,String email, String password,
                  Boolean newsletter, String tipo, Boolean banned, Boolean deleted) {
        this.idUtente = idUtente;
        this.nome = nome;
        this.cognome = cognome;
        this.username = username;
        this.email = email;
        this.password = password;
        this.newsletter = newsletter;
        this.tipo = tipo;
        this.banned = banned;
        this.deleted = deleted;
    }

    // get & set
    public Integer getIdUtente() {
        return idUtente;
    }

    public void setIdUtente(Integer idUtente) {
        this.idUtente = idUtente;
    }

    public String getNome() {
        return nome;
    }

    public void setNome(String nome) {
        this.nome = nome;
    }

    public String getCognome() {
        return cognome;
    }

    public void setCognome(String cognome) {
        this.cognome = cognome;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public Boolean isNewsletter() {
        return newsletter;
    }

    public void setNewsletter(Boolean newsletter) {
        this.newsletter = newsletter;
    }

    public String getTipo() {
        return tipo;
    }

    public void setTipo(String tipo) {
        this.tipo = tipo;
    }

    public Boolean isBanned() {
        return banned;
    }

    public void setBanned(Boolean banned) {
        this.banned = banned;
    }

    public Boolean isDeleted() {
        return deleted;
    }

    public void setDeleted(Boolean deleted) {
        this.deleted = deleted;
    }

    public String getUsername() {return username;}

    public void setUsername(String username) {this.username = username; }
}
```

# src\main\java\com\cineplex\cineplex\services\config\Configuration.java

```java
package com.cineplex.cineplex.services.config;

import com.cineplex.cineplex.model.dao.DAOFactory;

import  java.util.Calendar;
import java.util.logging.Level;

public class Configuration {
    /* Database Configruation */
    public static final String DAO_IMPL= DAOFactory.MYSQLJDBCIMPL;
    public static final String DATABASE_DRIVER="com.mysql.cj.jdbc.Driver";
    public static final String SERVER_TIMEZONE= Calendar.getInstance().getTimeZone().getID();
    public static final String
            DATABASE_URL="jdbc:mysql://localhost/cineplex?user=root&password=GinoPinguino123&allowPublicKeyRetrieval=true&useSSL=false&serverTimezone="+SERVER_TIMEZONE;

    /* Session Configuration */
    public static final String COOKIE_IMPL= DAOFactory.COOKIEIMPL;

    /* Logger Configuration */
    public static final String GLOBAL_LOGGER_NAME="cineplex";
    public static final String GLOBAL_LOGGER_FILE="/Users/bagyb/Documents/logs/cineplex_log.%g.%u.txt";
    public static final Level GLOBAL_LOGGER_LEVEL=Level.ALL;

}

```

# src\main\java\com\cineplex\cineplex\services\logservice\LogService.java

```java
package com.cineplex.cineplex.services.logservice;

import com.cineplex.cineplex.services.config.Configuration;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.util.logging.*;

public class LogService {
    private static Logger applicationLogger;

    private LogService() {
    }

    public static Logger getApplicationLogger() {
        if (applicationLogger == null) {
            applicationLogger = Logger.getLogger(Configuration.GLOBAL_LOGGER_NAME);
            setupLogger();
        }
        return applicationLogger;
    }

    private static void setupLogger() {
        try {
            // Ensure the directory exists
            Files.createDirectories(Paths.get(Configuration.GLOBAL_LOGGER_FILE).getParent());

            Handler fileHandler = new FileHandler(Configuration.GLOBAL_LOGGER_FILE, true);
            SimpleFormatter formatterTxt = new SimpleFormatter();
            fileHandler.setFormatter(formatterTxt);

            applicationLogger.addHandler(fileHandler);
            applicationLogger.setLevel(Configuration.GLOBAL_LOGGER_LEVEL);
            applicationLogger.setUseParentHandlers(false);

            applicationLogger.log(Level.CONFIG, "Logger: {0} created.", applicationLogger.getName());
        } catch (IOException e) {
            System.err.println("Error setting up logger: " + e.getMessage());
            e.printStackTrace();
        }
    }
}
```

# src\main\webapp\images\inception.jpg

This is a binary file of the type: Image

# src\main\webapp\images\lalaland.jpg

This is a binary file of the type: Image

# src\main\webapp\images\placeholder.jpg

This is a binary file of the type: Image

# src\main\webapp\include\footer.inc

```inc
<footer class="bg-gray-800 text-white mt-8 py-4">
        <div class="container mx-auto px-4 text-center">
            &copy; 2024 Cineplex. All rights reserved. | Developed by Enrico Davi
        </div>
    </footer>
</body>
</html>
```

# src\main\webapp\include\header.inc

```inc
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ page import="com.cineplex.cineplex.model.mo.Utente" %>
<%@ page import="com.cineplex.cineplex.model.dao.DAOFactory" %>
<%@ page import="com.cineplex.cineplex.model.dao.UtenteDAO" %>
<%@ page import="com.cineplex.cineplex.services.config.Configuration" %>
<%@ page import="java.util.HashMap" %>
<%@ page import="java.util.Map" %>
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cineplex</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
        }
        .logo {
            color: #4a4a4a;
            font-size: 2rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
    </style>
</head>
<body class="bg-gray-100">
    <%
        Utente loggedUser = null;
        Cookie[] cookies = request.getCookies();
        String loggedUserCookie = null;
        if (cookies != null) {
            for (Cookie cookie : cookies) {
                if (cookie.getName().equals("LoggedUser")) {
                    loggedUserCookie = cookie.getValue();
                    break;
                }
            }
        }

        if (loggedUserCookie != null && !loggedUserCookie.isEmpty()) {
            DAOFactory daoFactory = null;
            try {
                Map sessionFactoryParameters = new HashMap<String, Object>();
                sessionFactoryParameters.put("request", request);
                sessionFactoryParameters.put("response", response);
                daoFactory = DAOFactory.getDAOFactory(Configuration.COOKIE_IMPL, sessionFactoryParameters);
                daoFactory.beginTransaction();
                UtenteDAO sessionUserDAO = daoFactory.getUtenteDAO();
                loggedUser = sessionUserDAO.findLoggedUser();
                daoFactory.commitTransaction();
            } catch (Exception e) {
                if (daoFactory != null) daoFactory.rollbackTransaction();
            } finally {
                if (daoFactory != null) daoFactory.closeTransaction();
            }
        }

        if (loggedUser == null) {
            loggedUser = (Utente) session.getAttribute("loggedUser");
        }

        boolean loggedOn = (loggedUser != null);
    %>
<header class="bg-white shadow">
    <div class="container mx-auto px-4 py-4">
        <div class="flex justify-between items-center">
            <a href="${pageContext.request.contextPath}/Dispatcher" class="logo">Cineplex</a>
            <div class="flex items-center space-x-4">
                <% if (!loggedOn) { %>
                    <a href="${pageContext.request.contextPath}/Dispatcher?controllerAction=HomeManagement.loginView"
                       class="login-signup-btn">
                        Login/SignUp
                    </a>
                <% } else { %>
                    <div id="userMenuContainer" class="relative">
                        <button onclick="toggleUserMenu()" class="text-gray-600 hover:text-gray-900 focus:outline-none">
                            <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </button>
                        <div id="userDropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10">
                                <a href="${pageContext.request.contextPath}/Dispatcher?controllerAction=UtenteManagement.profile" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Profilo</a>
                                <a href="${pageContext.request.contextPath}/Dispatcher?controllerAction=BigliettoManagement.viewMyTickets" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">I miei biglietti</a>
                                <a href="${pageContext.request.contextPath}/Dispatcher?controllerAction=RecensioneManagement.insertReview" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Inserisci recensione</a>
                                <a href="${pageContext.request.contextPath}/Dispatcher?controllerAction=AbbonamentoManagement.viewSubscription" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Abbonamento</a>
                                <% if (loggedUser != null && "admin".equalsIgnoreCase(loggedUser.getTipo())) { %>
                                    <a href="${pageContext.request.contextPath}/Dispatcher?controllerAction=AdminManagement.console" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Console admin</a>
                                <% } %>
                                <a href="${pageContext.request.contextPath}/Dispatcher?controllerAction=HomeManagement.logout" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Logout</a>
                            <% } %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <style>
        .login-signup-btn {
            background-color: #3490dc;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }
        .login-signup-btn:hover {
            background-color: #2779bd;
        }
    </style>

    <script>
        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('hidden');
        }
    </script>
</body>
</html>
```

# src\main\webapp\index.jsp

```jsp
<%@ page session="false" %>
<%String contextPath=request.getContextPath();%>
<!DOCTYPE html>
<html lang="it-IT">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="refresh" content="0; url=<%=contextPath%>/Dispatcher">
  <script type="text/javascript">
    function onLoadHandler() {
      window.location.href = "<%=contextPath%>/Dispatcher";
    }
    window.addEventListener("load",onLoadHandler);

  </script>
  <title>Page Redirection</title>
</head>
<body>
  If you are not redirected automatically, follow this <a href="<%=contextPath%>/Dispatcher">link</a>
</body>
</html>
```

# src\main\webapp\jsp\filmManagement\film.jsp

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ page import="com.cineplex.cineplex.model.mo.Film" %>
<%@ include file="/include/header.inc" %>

<%
    Film film = (Film) request.getAttribute("film");
%>

<div class="container mx-auto mt-8">
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="md:flex">
            <div class="md:flex-shrink-0">
                <img class="h-48 w-full object-cover md:w-48" src="<%= film.getPercorsoLocandina() %>" alt="<%= film.getTitolo() %>">
            </div>
            <div class="p-8">
                <div class="uppercase tracking-wide text-sm text-indigo-500 font-semibold"><%= film.getDataPubblicazione().getYear() + 1900 %></div>
                <h1 class="mt-1 text-3xl leading-tight font-bold text-gray-900"><%= film.getTitolo() %></h1>
                <p class="mt-2 text-gray-600"><%= film.getDescrizione() %></p>
                <div class="mt-4">
                    <span class="text-gray-700 font-bold">Director:</span>
                    <span class="text-gray-600"><%= film.getRegista() %></span>
                </div>
                <div class="mt-2">
                    <span class="text-gray-700 font-bold">Duration:</span>
                    <span class="text-gray-600"><%= film.getDurataMinuti() %> minutes</span>
                </div>
                <div class="mt-4">
                    <a href="<%= film.getLinkTrailerYt() %>" target="_blank" class="inline-block bg-indigo-500 text-white px-4 py-2 rounded hover:bg-indigo-600">Watch Trailer</a>
                </div>
            </div>
        </div>
    </div>
</div>

<%@ include file="/include/footer.inc" %>
```

# src\main\webapp\jsp\homeManagement\login.jsp

```jsp
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ include file="/include/header.inc" %>

<div class="container mx-auto mt-8">
    <div class="max-w-md mx-auto bg-white rounded-lg overflow-hidden md:max-w-lg">
        <div class="md:flex">
            <div class="w-full px-6 py-8">
                <div id="loginForm">
                    <h2 class="text-center text-3xl font-bold mb-4">Login</h2>

                    <!-- Error message placement -->
                    <div id="errorMessage" class="mb-4 text-red-500 text-center hidden">
                        Incorrect username or password. Please try again.
                    </div>

                    <form action="${pageContext.request.contextPath}/Dispatcher" method="post" id="loginFormElement">
                        <input type="hidden" name="controllerAction" value="HomeManagement.login">
                        <div class="mb-4">
                            <label for="username" class="block text-gray-700 text-sm font-bold mb-2">Username</label>
                            <input type="text" id="username" name="username" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>
                        <div class="mb-6">
                            <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password</label>
                            <input type="password" id="password" name="password" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>
                        <div class="flex items-center justify-between">
                            <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                                Login
                            </button>
                            <a href="#" onclick="toggleForms()" class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800">
                                Sign Up
                            </a>
                        </div>
                    </form>
                </div>

                <!-- Signup form -->
                <div id="signupForm" class="hidden">
                    <h2 class="text-center text-3xl font-bold mb-4">Sign Up</h2>

                    <!-- Error message placement for signup -->
                    <div id="signupErrorMessage" class="mb-4 text-red-500 text-center hidden"></div>

                    <form action="${pageContext.request.contextPath}/Dispatcher" method="post">
                        <input type="hidden" name="controllerAction" value="HomeManagement.signup">
                        <div class="mb-4">
                            <label for="nome" class="block text-gray-700 text-sm font-bold mb-2">Nome</label>
                            <input type="text" id="nome" name="nome" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>
                        <div class="mb-4">
                            <label for="cognome" class="block text-gray-700 text-sm font-bold mb-2">Cognome</label>
                            <input type="text" id="cognome" name="cognome" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>
                        <div class="mb-4">
                            <label for="email" class="block text-gray-700 text-sm font-bold mb-2">Email</label>
                            <input type="email" id="email" name="email" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>
                        <div class="mb-4">
                            <label for="signupUsername" class="block text-gray-700 text-sm font-bold mb-2">Username</label>
                            <input type="text" id="signupUsername" name="username" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>
                        <div class="mb-4">
                            <label for="signupPassword" class="block text-gray-700 text-sm font-bold mb-2">Password</label>
                            <input type="password" id="signupPassword" name="password" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </div>
                        <div class="mb-4">
                            <label class="flex items-center">
                                <input type="checkbox" name="newsletter" class="form-checkbox">
                                <span class="ml-2 text-gray-700 text-sm">Subscribe to newsletter</span>
                            </label>
                        </div>
                        <div class="flex items-center justify-between">
                            <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                                Sign Up
                            </button>
                            <a href="#" onclick="toggleForms()" class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800">
                                Back to Login
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function toggleForms() {
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        loginForm.classList.toggle('hidden');
        signupForm.classList.toggle('hidden');
    }

    window.onload = function() {
        const loginError = <%= request.getAttribute("loginError") != null && (Boolean)request.getAttribute("loginError") %>;
        const signupError = "<%= request.getAttribute("signupError") != null ? request.getAttribute("signupError") : "" %>";

        if (loginError) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.classList.remove('hidden');
        }

        if (signupError) {
            const signupErrorMessage = document.getElementById('signupErrorMessage');
            signupErrorMessage.textContent = signupError;
            signupErrorMessage.classList.remove('hidden');
            toggleForms(); // Show signup form if there was an error
        }
    }
</script>

<%@ include file="/include/footer.inc" %>
```

# src\main\webapp\jsp\homeManagement\view.jsp

```jsp
<%@ page import="com.cineplex.cineplex.model.mo.Film" %>
<%@ page import="java.util.List" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ include file="/include/header.inc" %>

<div id="successPopup" class="fixed top-0 left-0 right-0 z-50 hidden">
    <div class="bg-green-500 text-white px-6 py-4 mx-auto mt-4 rounded-lg shadow-lg max-w-md text-center">
        <p>Login successful!</p>
    </div>
</div>

<div class="container mx-auto mt-8">
    <h1 class="text-3xl font-bold mb-4">Welcome to Cineplex</h1>
    <p class="text-lg">Enjoy the latest movies and exclusive content.</p>
</div>


<div class="container mx-auto mt-8">
    <h2 class="text-2xl font-bold mb-4">Featured Films</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        <%
            List<Film> films = (List<Film>) request.getAttribute("films");
            if (films != null && !films.isEmpty()) {
                for (Film film : films) {
        %>
        <a href="<%= request.getContextPath() %>/Dispatcher?controllerAction=FilmManagement.viewFilm&filmId=<%= film.getIdFilm() %>" class="block">
            <div class="bg-white rounded-lg shadow-md overflow-hidden">
                <img src="<%= request.getContextPath() %><%= film.getPercorsoLocandina() %>"
                     alt="<%= film.getTitolo() %>"
                     class="w-full h-48 object-cover"
                     onerror="this.onerror=null; this.src='<%= request.getContextPath() %>/images/placeholder.jpg';">
                <div class="p-4">
                    <h3 class="font-bold text-lg mb-2"><%= film.getTitolo() %></h3>
                    <p class="text-gray-600"><%= film.getDataPubblicazione().getYear() + 1900 %></p>
                </div>
            </div>
        </a>
        <%
            }
        } else {
        %>
        <p>No films available at the moment.</p>
        <%
            }
        %>
    </div>
</div>

<script>
    window.onload = function() {
        const loginSuccess = <%= request.getAttribute("loginSuccess") != null && (Boolean)request.getAttribute("loginSuccess") %>;
        console.log("Login success:", loginSuccess); // For debugging
        if (loginSuccess) {
            const successPopup = document.getElementById('successPopup');
            successPopup.classList.remove('hidden');
            setTimeout(() => {
                successPopup.classList.add('hidden');
            }, 3000);
        }
    }
</script>

<%@ include file="/include/footer.inc" %>
```

# src\main\webapp\WEB-INF\web.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="https://jakarta.ee/xml/ns/jakartaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
         version="5.0">

    <servlet>
        <servlet-name>Dispatcher</servlet-name>
        <servlet-class>com.cineplex.cineplex.dispatcher.Dispatcher</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>Dispatcher</servlet-name>
        <url-pattern>/Dispatcher</url-pattern>
    </servlet-mapping>

    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>

    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>/images/*</url-pattern>
    </servlet-mapping>

</web-app>
```

